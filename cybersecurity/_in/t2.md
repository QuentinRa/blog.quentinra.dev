# T2

**https://tryhackme.com/room/adventofcyber2**

Day 7

* https://techterms.com/
* ip, protocols, tcp, wireshark

**https://tryhackme.com/room/adventofcyber4**

Day 12

* Persistence (Registry Run Keys)
* https://github.com/horsicq/Detect-It-Easy
* https://github.com/mandiant/capa
* packed file (upx, unpack with upx -d as root?)
* ProcMon dynamic analysis

Day 13

* Wireshark
* https://tryhackme.com/module/wireshark or https://tryhackme.com/module/network-security-and-traffic-analysis
* Stats > Conversations
* HTTP check user-agents

Day 15

* reverse shell, file upload
* ` msfconsole -q -x "use xxx; [...]"`
* file renaming
* malware analysis

Day 16

* xxx

Day 17

* xxx

Day 18

* xxx

Day 19

* xxx

Day 20

* xxx

Day 21

* xxx

Day 24

* xxx

**https://tryhackme.com/room/quotient**

* ???

**https://tryhackme.com/room/redteamengagements**

* Campaign
  * Engagement Plan: document what we will do
    * CONOPS (semi-technical)
    * Resource plan (dates, knowledge, resources)
  * Operations Plan (specific details, ex: when to stop/...)
  * Mission Plan (internal, objectives, targets...)
  * Remediation Plan (optional)
* Cobalt Strike
* https://vectr.io/
* phising with mshta

**https://tryhackme.com/room/redteamrecon**

* Stuff: active/passive recon, packet tracing, whois, host, shodan, maltego, recon-ng
* Active
  * Internal (Nessus)
  * External (Nikto...)
* host domain: list IPV4/6 resolved by domain
* passive: find documents, endpoints
* Google Hacking Database (GHDB)
* https://viewdns.info/ (reverse IP)
* https://threatintelligenceplatform.com/ (analyze domain)
* https://search.censys.io/ (dig one IP)
* recon-ng: automates OSINT
  * recon-ng: start
    * recon-ng -w xxx: start in workspace
  * workspaces create xxx
  * db insert domains: add domain
  * marketplace search/info/install/remove
  * modules search/load
  * options list/set
  * run
* Maltego
  * Entities
  * Transform to query info about an Entity

**https://tryhackme.com/room/weaponization**

* https://github.com/infosecn1nja/Red-Teaming-Toolkit
* .exe are often blocked
* Windows Script Host (WSH)
* HTML Application (HTA)
* Visual Basic Applications (VBA)
* PowerShell (PSH)

**https://tryhackme.com/room/webosint**

* xxx

**https://tryhackme.com/room/ccpentesting**

* xxx

**https://tryhackme.com/room/malmalintroductory**

* xxx

**https://tryhackme.com/room/introtodetectionengineering**

* identify threats, detect them
  * Environment-based: change in the env
    * Configuration Detection
    * Modelling (define base, identify delta)
  * Threat-based: activity
    * Threat Behaviour Detection (TTP)
    * Detection as Code
* Detection Gap Analysis
  * Find areas of improvement
  * threat modeling (reactive vs proactive)
  * https://tryhackme.com/room/yara
  * https://tryhackme.com/room/sigma
  * https://car.mitre.org/
  * Pyramid of Pain
  * https://tryhackme.com/room/pyramidofpainax
  * https://tryhackme.com/room/cyberkillchainzmt
  * https://tryhackme.com/room/unifiedkillchain
  * https://tryhackme.com/room/mitre
  * ...
* https://github.com/palantir/alerting-detection-strategy-framework
* Detection Maturity Level Model

**https://tryhackme.com/room/wiresharkthebasics**

* Can merge PCAP files
* Statistics > Capture file properties
* wireshark do packet (protocol) dissection (split in IP/...)
* Edit > Find Packet
  * Type
  * Where
* CTRL+G (go to)
* CTRL+M (mark packet), Right-click "Packet comment"...
* View> Time display format (to change from using seconds since start of the capture)
* Analyze > Expert informations (problems/...)
* If you find a section JPEG in a packet, you can export in by right-clicking on it, then export packet bytes (or any file!)
* Right-click on something > apply as filter
* Right-click > Conversation filter (the conversation). You can colorize a conversation (alternatively).
* Right-click on a field => apply as column
* Follow > TCP stream

**https://tryhackme.com/room/cryptographyintro**

* Caesar, Sym, Asymm, RSA, Diffie, GPG, HMAC, Certificates, salt, SSL
* Transposition cipher (write in columns of same height=from top to bottom, mix columns, and read the cipher in rows)
* https://www.quipqiup.com/
* Programs for symmetric encryption
  * GNU Privacy Guard (GPG, GnuPG)
    * `gpg --symmetric --cipher-algo ALGO msg.txt`
    * `gpg --version`: list ciphers
    * `--armor` for ASCII instead of binary output
    * `gpg --output xxx --decrypt yyy.gpg`
  * OpenSSL Project
    * `openssl xxx [-e[-d]] -in file -out file`
    * xxx: rsa/dhparam (cannot -e/-d)...
    * see also: iter, pbkdf2
    * to see RSA/diffie variables, use `-text -noout` instead of `-out file`
    * `openssl pkeyutl [-encrypt/-decrypt] -in xxx -out yyy -inkey key [-pubin]`: encrypt/decrypt [using public key]
* In Asymmetric, private key can be used to encrypt, and public key to decrypt, to verify that a message comes from bob.
* Fix RSA (message, k=>e)
* `ls -lh` (human readable size)
* HMAC
  * hmac256/sha256hmac/...
  * `hmac256 key file`
* `sudo apt list libgcrypt*`
* `sudo apt install libgcrypt20-dev`
* [crazyuploader/TIL](https://github.com/crazyuploader/TIL)
* [proxy-list](https://github.com/jetkai/proxy-list)
* Salt/SSL notes
* [Password Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html)

**https://tryhackme.com/room/wiresharkpacketoperations**

* Statistics > Resolved address (domain name/IP)
* Protocol hierarchy
* Wireshark can use [GEOIP](https://wiki.wireshark.org/HowToUseGeoIP)
  * Edit > Preferences > Name resolution > Resolve network (IP) addresses
  * In Endpoint, can see locations, and organizations
* Can have stats per IP
* `http.host == "example.com"`
* Display filter != Capture filter (was using the former)
* Display filter expression
* !(xxx) instead of negating operators
* xxx in {a b c}
* Other advanced operations
* Analyze > Display filter expression