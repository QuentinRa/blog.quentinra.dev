# File investigation

<div class="row row-cols-md-2"><div>

Any file you find, be it during [Digital forensics](/cybersecurity/blue-team/topics/forensics.md) or during the red team activities, may have:

* üêü Hidden content in a file
  * A file inside another file
  * A text inside an image
* üëÄ Username/Name of the one that created the file
* üç´ Information generated by the application that created the file
* ...
</div><div>

This is why you should investigate any file you get your hands on.
 
‚û°Ô∏è For instance, if you notice a "big" image <small>(usually >1 MB)</small>, you may want to check if this is really an image.
</div></div>

<hr class="sep-both">

## Metadata

[![introdigitalforensics](../../_badges/thm/introdigitalforensics.svg)](https://tryhackme.com/room/introdigitalforensics)

<div class="row row-cols-md-2"><div>

Any file has metadata, which is data that provides information on the file, such as the author, the creation date...

#### PDF metadata

You can use online tools, your PDF reader "details" menu, or `pdfinfo`.

```shell!
$ sudo apt install poppler-utils
$ pdfinfo xxx.pdf
Author:         XXX
Creator:        Microsoft Word
CreationDate:   Sun Aug 28 22:12:17 2022 EDT
ModDate:        Sun Aug 28 22:12:17 2022 EDT
[...]
PDF version:    1.7
```
</div><div>

#### Image metadata

[![agentsudoctf](../../_badges/thm-p/agentsudoctf.svg)](https://tryhackme.com/room/agentsudoctf)

You can use `exiftool`, [jimpl](https://jimpl.com/), [IMV](https://www.geekyhumans.com/tools/image-metadata-viewer)... Also, do a reverse image search üßµ.

```shell!
$ sudo apt install libimage-exiftool-perl
$ exiftool xxx.png
[...]
File Modification Date/Time     : 2022:10:22 18:01:32-04:00
[...]
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
[...]
Software                        : www.inkscape.org
[...]
```
</div></div>

<hr class="sep-both">

## Steganography

[![agentsudoctf](../../_badges/thm-p/agentsudoctf.svg)](https://tryhackme.com/room/agentsudoctf)
[![c4ptur3th3fl4g](../../_badges/thm-p/c4ptur3th3fl4g.svg)](https://tryhackme.com/room/c4ptur3th3fl4g)

<div class="row row-cols-md-2"><div>

Steganography is a technique in which a person hides data inside the pixels of an image. It's used to secretly transfer data.

If the hidden content is not protected by a password, you can extract it using the `steghide` command:

```ps
$ steghide info file # check
$ steghide extract -sf file # extract
```

‚û°Ô∏è If prompted for a password, try a blank password.
</div><div>

Otherwise, you may try to [crack](/cybersecurity/red-team/s3.exploitation/index.md#password-cracking-) the password.

```ps
# https://github.com/RickdeJager/stegseek
$ stegseek file wordlist
```

üê∏ See also [futureboy](https://futureboy.us/stegano/) steg tools.

üíé It's possible that when using the `strings` command we see some interesting parts of the hidden content.
</div></div>

<hr class="sep-both">

## File steganography

[![agentsudoctf](../../_badges/thm-p/agentsudoctf.svg)](https://tryhackme.com/room/agentsudoctf)

<div class="row row-cols-md-2"><div>

File steganography is a subcategory of steganography in which a file is hidden in another file. Using [binwalk](https://github.com/ReFirmLabs/binwalk) (8.7k ‚≠ê) you can investigate:

```ps
$ binwalk file.png
# from xxx to yyy: PNG
# from zzz to ttt: ZIP
```

And you can extract files using `-e`

```ps
$ binwalk -e file.png
```
</div><div>

You can alternatively use `dd` to extract a file:

```ps
# extract the size by skipping the 34562 bytes
$ dd bs=34562 skip=1 if=file.png of=file.zip
$ ls
file.png file.zip
```

üëâ If there was a ZIP inside the PNG, and you can't unzip it, try with `7z x xxx.zip` or use `dd` to extract the file.
</div></div>

<hr class="sep-both">

## Audio files

[![c4ptur3th3fl4g](../../_badges/thm-p/c4ptur3th3fl4g.svg)](https://tryhackme.com/room/c4ptur3th3fl4g)

<div class="row row-cols-md-2"><div>

You can use [Audacity](https://www.audacityteam.org/) to analyze audio files.

```
$ sudo apt install audacity
```

Open the file, click on the filename, and select wav to spectrogram.
</div><div>

See also: [academo spectrum analyzer](https://academo.org/demos/spectrum-analyzer/) or [morsecode audio decoder](https://morsecode.world/international/decoder/audio-decoder-adaptive.html).
</div></div>

<hr class="sep-both">

## üëª To-do üëª

Stuff that I found, but never read/used yet.

<div class="row row-cols-md-2"><div>

* Stegosploit
</div><div>

</div></div>