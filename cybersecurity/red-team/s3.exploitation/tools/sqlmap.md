# SQLMap

[![sqlilab](../../../_badges/thm/sqlilab.svg)](https://tryhackme.com/room/sqlilab)
[![sqlmapessentials](../../../_badges/htb/sqlmapessentials.svg)](https://academy.hackthebox.com/course/preview/sqlmap-essentials)

<div class="row row-cols-md-2"><div>

[sqlmap](https://github.com/sqlmapproject/sqlmap) (29.4k ⭐) is a tool to detect and automatically exploit SQLi. While it may perform just fine out of the box, we will have to configure it adequately for complex targets to avoid false negatives.

To ensure the request <small>(GET/POST/PUT/...)</small> is correct, we usually capture it using a tool such as [Burp Intruder](burp.md) or from a web browser network tab, by right-clicking on the request and selecting `Copy value as cURL`.  This ensures headers and cookies are properly configured.
</div><div>

**Where to learn?** 🎓

* [Official Documentation](https://github.com/sqlmapproject/sqlmap/wiki/Usage) (📚)
* [SQLMap CheatSheet](https://www.daronwolff.com/sqlmap-cheetsheet/) (2020)
* [SQLMap CheatSheet](https://www.security-sleuth.com/sleuth-blog/2017/1/3/sqlmap-cheat-sheet) (2017)
</div></div>

<hr class="sep-both">

## Basic Overview

<div class="row row-cols-lg-2"><div>

To use the tool, we must first find a potentially vulnerable form/URL.

```ps
$ sqlmap -u example.com/?id=1 [...]              # GET
$ sqlmap -u example.com --data="id=1&p=0" [...]  # POST
$ sqlmap -u example.com --data-raw "id=1" [...]  # POST (cURL)
$ sqlmap -u URL --data="id=1" --method PUT [...] # PUT
$ sqlmap [...] -H 'Cookie: id=1' # add headers
```

After that, the tool will ask us a few questions to configure itself. We can skip them and use default values using `--batch`.

```ps
$ sqlmap [...] --batch
```
</div><div>

**Security by-pass** 🔏

* `--random-agent`: by-pass some WAF/...
</div></div>


<hr class="sep-both">

## Notes (new) 👑

<div class="row row-cols-md-2"><div>

```ps
$ sqlmap [...] --level=5 --risk=3 --dbms=sqlite --technique=b --dump
$ sqlmap [...] --threads 10
```

Parameters that are required/recommended to add

* `-u URL`: try injecting this URL
    * `--dbms=some_dbms`: sqlite...
    * `--data="body"`:
    * `-p param`:

</div><div>

Configuration 🐍️

* `--technique`:
    * `--level`:
    * `--risk`:
    * `--threads n`: use $n$ threads, work faster the more there are.

Operations ⚒️

* `--dump`:
</div></div>

<hr class="sep-both">

## Notes (old) 💨

<div class="row row-cols-md-2 mt-4"><div>

* `-u URL`: try injecting this URL
    * `--dbs`: display all databases
    * `--tables`: display tables
    * `--column`: display columns
    * `-C xx, yy`: display only columns xx, and yy

</div><div>

* `-D db_name`: the name of the database
    * `--time-sec timeout`: specify a timeout
    * `--dump`: save current data
    * `--dump-all`: save all data
</div></div>
