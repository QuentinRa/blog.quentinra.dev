# Third step - Exploitation

[![vulnerabilities101](../../_badges/thm/vulnerabilities101.svg)](https://tryhackme.com/room/vulnerabilities101)
[![exploitingavulnerabilityv2](../../_badges/thmp/exploitingavulnerabilityv2.svg)](https://tryhackme.com/room/exploitingavulnerabilityv2)
[![vulnerabilitycapstone](../../_badges/thmp/vulnerabilitycapstone.svg)](https://tryhackme.com/room/vulnerabilitycapstone)
[![attackerkb](../../_badges/thm/attackerkb.svg)](https://tryhackme.com/room/attackerkb)

<div class="row row-cols-md-2"><div>

Exploitation 💥 is the third step of the pentester activities. We attempt to exploit a vulnerability discovered during investigation.

Some activities are:

* 🔑 Brute forcing credentials
* 💀 Exploiting a known (unpatched) vulnerability
  * in a service
  * in an application
  * in a website/an api
  * ...
* ...
</div><div>

Vulnerabilities can be categorized in 5 categories:

* 🪸 Operating System
* 🔥 Misconfigurations <small>(Version Disclosure, Sensitive Data Exposure, Security Misconfigurations)</small>
* 🔏 Weak credentials
* 😎 Logic flaws <small>(Insecure Deserialization)</small>
* 🧑 Human errors

Note that not all vulnerabilities are exploitable, and not all vulnerabilities have a public exploit to exploit them.
</div></div>

<hr class="sep-both">

## Vulnerability databases

<div class="row row-cols-md-2 mt-4"><div>

#### Vulnerabilities identifiers

To identify and classify vulnerabilities, you can use:

* 📌 **CVE** <small>(Common Vulnerabilities and Exposures)</small> is a dictionary of every known vulnerability. The format is **CVE-YEAR-ID**.

* 📝 **CWE** <small>(Common Weakness Enumeration)</small> is a list of common weaknesses in applications, grouped in categories.

<br>

#### Vulnerability scoring

There are 2 well-known systems to rank vulnerabilities.

* 🍀 **CVSS** <small>(Common Vulnerability Scoring System)</small> which was released in 2005, and is free and open-source. [A CVE is ranked from 0 to 10](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator).

* 💵 **VPR** <small>(Vulnerability Priority Rating)</small> is a modern way based on the risk for the organization that uses it. It ranges from 0 to 100.

<br>

#### Proof Of Concept

When a vulnerability is discovered, a proof of concept (**PoC**) may be written to demonstrate that the vulnerability is exploitable. As a pentester, you may look for them to exploit a vulnerability.

➡️ Use GitHub, GitLab, and Google to look for them...
</div><div>

There are **many** vulnerability databases. You should use 2-3 as they may have different information <small>(community info, list of exploits...)</small>.

* [Exploit DB](db/exploit_db.md) - vulnerability with exploits

* [Attacker KB](db/attacker_kb.md) - community reviews

* [CVE details](db/cve_details.md) - every CVE

* [CVE.ORG (MITRE)](db/cve_org.md) - ...

* [Snyk](db/snyk.md) - focus on web applications

* [Rapid7](db/rapid7.md) - xxx

* [Circl](db/circl.md) - xxx

* [NIST](db/nist.md) - xxx

* [MSRC (Microsoft)](db/msrc.md) - xxx

* [vulners](db/vulners.md) - xxx

* [Trickest/CVE](db/trickest_cve.md) - xxx

* [CVEList](db/cvelist.md) - xxx

* [InTheWild](db/inthewild.md) - xxx

</div></div>

<hr class="sep-both">

## Attacks

<div class="row row-cols-md-2"><div>

#### Brute force

...
</div><div>
</div></div>

<hr class="sep-both">

## 👻 To-do 👻

Stuff that I found, but never read/used yet.

<div class="row row-cols-md-2"><div>

* rootkit, bootkit
* memory leaks
* overflow (change the return pointer in the stack with a parameter that overflow)
* Passive attacks (monitor)
* Active attacks
* `select sql from sqlite_master`
* Server-Side Template Injection
* fault injection
* Preconfigured account with well-known passwords
* password reuse
* [ZDI](https://www.zerodayinitiative.com/)
* [GitHub Advisory Database](https://github.com/advisories).

SQL

* sql truncation attack
* [DSSS](https://github.com/stamparm/DSSS)
* [whitewidow](https://github.com/WhitewidowScanner/whitewidow)

```
=> file permission (root)
UNION ALL SELECT LOAD_FILE('/etc/passwd')--
UNION SELECT "<? system($_REQUEST['cmd']); ?>" INTO OUTFILE
```

Auth

* bruteforce
* insecure passwords
* (un|badly)encrypted passwords
* vulnerable reset password (easy reset questions)
* auth token in URL
* failure when logging with google (can find the "default" password)
* default accounts/...

Networking

* Cain and abel
* Ettercap
</div><div>

Security questions

* must be fixed
* straightforward/easy to remember
* must be encrypted

XXE

* API SOAP (DTD)
* Configuration to disable XXE
* File Upload (network request)
</div></div>