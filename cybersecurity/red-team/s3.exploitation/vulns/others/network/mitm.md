# Man-in-the-middle attack

<div class="row row-cols-lg-2"><div>

A Man-in-the-middle <small>(M-I-T-M)</small> design an attack where an attacker seats between clients and their target server.

* They fooled the client and made them believe they are the 'server'
* They are able to access and maybe edit/drop every message

The hacker will most likely be able to read hashes or credentials sent over the network allowing them to compromise more accounts 🔑.
</div><div>

See also: [LLMNR/NBT-NS Poisoning](/cybersecurity/red-team/s2.discovery/techniques/network/poisoning.md).
</div></div>

<hr class="sep-both">

## Common tools

<div class="row row-cols-lg-2"><div>

#### Inveigh

[![active_directory_enumeration_attacks](../../../../../_badges/htb/active_directory_enumeration_attacks.svg)](https://academy.hackthebox.com/course/preview/active-directory-enumeration--attacks)

[Inveigh](https://github.com/Kevin-Robertson/Inveigh) <small>(2.3k ⭐)</small> is a M-I-T-M tool on Windows.

The PS1 script is deprecated:

```ps
PS> Import-Module .\Inveigh.ps1
PS> Invoke-Inveigh Y -NBNS Y -ConsoleOutput Y -FileOutput Y
```

You can use the executable if you have admin privileges:

```ps
PS> .\Inveigh.exe
...
HELP<cr>
PROMPT> GET NTLMV2UNIQUE
PROMPT> GET NTLMV2USERNAMES
```
</div><div>

#### Ettercap

[![attacking_common_services](../../../../../_badges/htb/attacking_common_services.svg)](https://academy.hackthebox.com/course/preview/attacking-common-services)

[Ettercap](https://github.com/Ettercap/ettercap) <small>(2.2k ⭐)</small> is a M-I-T-M tool.

```shell!
$ cat /etc/ettercap/etter.dns
example.com      A   X.X.X.X
*.example.com    A   X.X.X.X
```

* Navigate to `Hosts > Scan for Hosts`
* Edit the host configuration
* Navigate to `Plugins > Manage Plugins`
* Active to a `dns_spoof` attack.
</div></div>

<hr class="sep-both">

## 👻 To-do 👻

Stuff that I found, but never read/used yet.

<div class="row row-cols-lg-2"><div>

[![windows_privilege_escalation](../../../../../_badges/htb/windows_privilege_escalation.svg)](https://academy.hackthebox.com/course/preview/windows-privilege-escalation)

Disable the global query list and create a WPAD record.

```ps
PS> Set-DnsServerGlobalQueryBlockList -Enable $false -ComputerName dc01.example.com
PS> Add-D