# Insecure Deserialization

[![owasptop10](../../../../_badges/thm/owasptop10.svg)](https://tryhackme.com/room/owasptop10)
[![deserialization](../../../../_badges/owasp/deserialization.svg)](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html)

<div class="row row-cols-lg-2"><div>

Insecure Deserialization is a vulnerability that occurs when the deserialization process can be exploited to run malicious code.
</div><div>
</div></div>

<hr class="sep-both">

## Example CVEs

<div class="row row-cols-lg-2"><div>

#### CVE-2021-33026 (Flask/Python)

[![owasptop10](../../../../_badges/thm/owasptop10.svg)](https://tryhackme.com/room/owasptop10)
[![flask_unsecure_session](../../../../_badges/rootme/web_server/flask_unsecure_session.svg)](https://www.root-me.org/en/Challenges/Web-Server/Flask-Unsecure-session)

An insure deserialization in Flask (Python) allowed  a hacker to craft a malicious [cookie](/programming-languages/web/_general/random/cookies.md) with a command inside. When the cookie was deserialized, the command was executed by the server.

* Cookies can be read without the secret key
* Cookies can be forged with the secret key
* [kirsle flask cookie reader](https://www.kirsle.net/wizards/flask-session.cgi) (Website)
* See also: [flask-session-manager](https://github.com/noraj/flask-session-cookie-manager) <small>(0.5k ⭐)</small> or [Flask Unsign](https://github.com/Paradoxis/Flask-Unsign)  <small>(0.3k ⭐)</small>

```shell!
$ pip3 install flask-unsign[wordlist]
$ sudo ln -s /home/<xxx>/.local/bin/flask-unsign /usr/bin/flask-unsign
$ flask-unsign --decode --cookie 'cookie'        # decode
$ flask-unsign --unsign --cookie 'cookie'        # find key
$ flask-unsign --sign --cookie '' --secret 'dev' # encode
```
</div><div>
</div></div>