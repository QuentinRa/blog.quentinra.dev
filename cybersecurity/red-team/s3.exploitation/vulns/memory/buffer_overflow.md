# Buffer Overflow

[![stack_based_buffer_overflows_linux_x86](../../../../_badges/htb/stack_based_buffer_overflows_linux_x86.svg)](https://academy.hackthebox.com/course/preview/stack-based-buffer-overflows-on-linux-x86)

<div class="row row-cols-lg-2"><div>

Buffers overflows occur when a user is able to inject more data that the system can handle, resulting in an overflow.

By overriding data, the user may be able to control and modify the program behavior, such as executing malicious code.

A buffer overflow can be categorized in

* **Stack-based** Buffer Overflow ğŸ—ƒï¸
* **Heap-based** Buffer Overflow ğŸŒ±

</div><div>

Buffers overflows are less common nowadays, mostly due to the implementation of several security mechanisms.

* ğŸª¤ **Data Execution Prevention** (DEP): mark as "read-only" memory regions where user input is stored such as the stack
* ğŸ›£ï¸ **Address Space Layout Randomization** (ASLR): randomize where everything is stored to make ROP attacks harder
* xxx
* xxx

ğŸ“š IoT and Embedded devices are a common target as they often use low-level vulnerable languages such as `C` or `C++`.
</div></div>

<hr class="sep-both">

## Stack-based Buffer Overflow

[![stack_based_buffer_overflows_linux_x86](../../../../_badges/htb/stack_based_buffer_overflows_linux_x86.svg)](https://academy.hackthebox.com/course/preview/stack-based-buffer-overflows-on-linux-x86)

<div class="row row-cols-lg-2"><div>

The use of the following C functions:

* `strcpy`
* `sprintf`
* `gets`/`fgets`
* `scanf`/`fscanf`
* `strcat`
* ...
</div><div>
</div></div>

<hr class="sep-both">

## ğŸ‘» To-do ğŸ‘»

Stuff that I found, but never read/used yet.

<div class="row row-cols-lg-2"><div>

* `CVE-2021-3156` in sudo
* Attack: make the program crash (benign)
* Return Oriented Programming (ROP)
* `Heap => go from the 0x0 to 0xf. Start at the end of .bss in x86.`, `Stack => go from 0xf to 0x0`.
</div><div>

```
# disable ASLR
sudo echo 0 > /proc/sys/kernel/randomize_va_space
# compile 32-bit ELF binary (no DEP)
gcc xxx.c -o xxx -fno-stack-protector -z execstack -m32
```
</div></div>