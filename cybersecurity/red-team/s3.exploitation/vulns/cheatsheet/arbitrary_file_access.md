# Arbitrary File Access

[![server_side_attacks](../../../../_badges/htb/server_side_attacks.svg)](https://academy.hackthebox.com/course/preview/server-side-attacks)
[![ssrfhr](../../../../_badges/thm/ssrfhr.svg)](https://tryhackme.com/room/ssrfhr)
[![filepathtraversal](../../../../_badges/thm/filepathtraversal.svg)](https://tryhackme.com/r/room/filepathtraversal)
[![ssrfqi](../../../../_badges/thmp/ssrfqi.svg)](https://tryhackme.com/room/ssrfqi)
[![flask_development_server](../../../../_badges/rootme/web_server/flask_development_server.svg)](https://www.root-me.org/en/Challenges/Web-Server/Flask-Development-server)

Multiple attacks may allow us to arbitrarily read or write files.

<div class="row row-cols-lg-2"><div>

#### Interesting Files To Read ü§ñ

* `/etc/passwd`, `/etc/group`: users and groups
* `/proc/self/environ`: current process environment
* `/proc/self/status` and `/proc/self/cmdline`: command
* `/etc/hosts`, `c:\windows\system32\drivers\etc\hosts`: virtual hosts
* `/home/<username>/.bash_history`: command history
* `/etc/crontab`: cron tasks
* `/var/lib/dpkg/status` and alternatives: installed packages
* `wp-config.php` and application-specific configuration files
* `/etc/ssh/sshd_config`: may contain usernames

LocateDB may be present and in-use. We may use it to find interesting paths. Load any of them using `locate -d ./xxxdb [...]`:

* `/var/cache/locate/locatedb`
* `/var/lib/mlocate/mlocate.db`
* `/var/lib/plocate/plocate.db`
</div><div>

#### Interesting Files To Write üê≤

* `/etc/shadow`, `/etc/passwd`: add/edit users
* `/etc/group`: add/edit groups
* `/etc/sudoers`: add/edit privileged users
</div></div>

<hr class="sep-both">

## üëª To-do üëª

Stuff that I found, but never read/used yet.

<div class="row row-cols-lg-2"><div>

* default webserver roots
* can be fuzzed
* wordlists
    * `default-web-root-directory-linux.txt`
    * `default-web-root-directory-windows.txt`
    * [SecLists LFI](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI)
    * `/etc/php/X.Y/apache2/php.ini` (web root)
    * `/etc/php/X.Y/fpm/php.ini` (web root)
* `C:\Windows\boot.ini`
</div><div>
</div></div>