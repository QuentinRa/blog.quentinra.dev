# Arbitrary File Access

[![server_side_attacks](../../../../_badges/htb/server_side_attacks.svg)](https://academy.hackthebox.com/course/preview/server-side-attacks)
[![ssrfhr](../../../../_badges/thm/ssrfhr.svg)](https://tryhackme.com/room/ssrfhr)
[![filepathtraversal](../../../../_badges/thm/filepathtraversal.svg)](https://tryhackme.com/r/room/filepathtraversal)
[![ssrfqi](../../../../_badges/thmp/ssrfqi.svg)](https://tryhackme.com/room/ssrfqi)
[![flask_development_server](../../../../_badges/rootme/web_server/flask_development_server.svg)](https://www.root-me.org/en/Challenges/Web-Server/Flask-Development-server)

Multiple attacks may allow us to arbitrarily read or write files.

<div class="row row-cols-lg-2"><div>

#### Interesting Files To Read ü§ñ

* `/etc/passwd`, `/etc/group`: users and groups
* `/proc/self/environ`: current process environment
* `/proc/self/status` and `/proc/self/cmdline`: command
* `/etc/hosts`, `c:\windows\system32\drivers\etc\hosts`: virtual hosts
* `/home/<username>/.bash_history`: command history
* `/etc/crontab`: cron tasks
* `/var/lib/dpkg/status` and alternatives: installed packages
* `wp-config.php` and application-specific configuration files
* `/etc/ssh/sshd_config`: may contain usernames
* `/var/lib/dhcp/dhclient.leases`: DHCP configuration

LocateDB may be present and in-use. We may use it to find interesting paths. Load any of them using `locate -d ./xxxdb [...]`:

* `/var/cache/locate/locatedb`
* `/var/lib/mlocate/mlocate.db`
* `/var/lib/plocate/plocate.db`

Don't forget DNS-related files and DHCP lease files.
</div><div>

#### Interesting Files To Write üê≤

* `/etc/shadow`, `/etc/passwd`: add/edit users
* `/etc/group`: add/edit groups
* `/etc/sudoers`: add/edit privileged users

<br>

#### Interesting Files To Know on Windows üï∑Ô∏è

* `c:/windows/win.ini`: nothing of interest
* `C:/Windows/boot.ini`: not always present

#### Interesting Files To Know on Linux üï∑Ô∏è

These files almost always exist and return a known value:

* `/proc/sys/kernel/ostype`: often contains `Linux`
* `/proc/sys/kernel/randomize_va_space`: often contains `2`
* `/sys/module/apparmor/parameters/enabled`: often contains `Y\n`
* `/proc/sys/kernel/pid_max`: often contains `32768`/`4194304`
* `/sys/class/power_supply/BAT{n}/type`: often contains `Battery`
* `/sys/class/tty/tty0/active`: contains a value such as `tty1`
* `/sys/class/power_supply/AC{n}/online`: contains either `0` or `1`
* `/sys/class/net/eth0/type`: contains `1`?
</div></div>

<hr class="sep-both">

## üëª To-do üëª

Stuff that I found, but never read/used yet.

<div class="row row-cols-lg-2"><div>

* default webserver roots
* can be fuzzed
* wordlists
    * `default-web-root-directory-linux.txt`
    * `default-web-root-directory-windows.txt`
    * [SecLists LFI](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI)
    * `/etc/php/X.Y/apache2/php.ini` (web root)
    * `/etc/php/X.Y/fpm/php.ini` (web root)
* `C:\Windows\boot.ini`
</div><div>

* `/usr/lib/python`
* `/var/spool/cron/crontabs`, `/etc/crontab`, `/etc/cron.d/`, `/etc/cron.daily/`, `/etc/cron.hourly/`, `/etc/cron.weekly/`, `/etc/cron.monthly/`
* `/etc/php/X.X/apache2/php.ini`
* `/etc/apache2/sites-enabled/`, `/var/log/apache2/`
* `/proc/net/arp`, `/sys/class/net/eth0/address`, `/proc/sys/kernel/random/boot_id`, `/proc/self/cgroup`
</div></div>