# NoSQL Injection (NoSQLi)

[![nosql_injection_authentication](../../../../_badges/rootme/web_server/nosql_injection_authentication.svg)](https://www.root-me.org/en/Challenges/Web-Server/NoSQL-injection-Authentication)

<div class="row row-cols-lg-2"><div>

According to a company or an application needs, a NoSQL database may be used instead of the traditional SQL database. This is often the case when using [GraphQL](/programming-languages/others/apis/graphql/index.md) API Model.

While NoSQL database such as MongoDB are inherently more resilient to common attacks, they may still be exploited.

Assuming, we have the following PHP code:

```php!
// dummy.php?username=admin&password=toto
$result = $db_accounts->find([
  'username'=> $_GET['username'],
  'password' => $_GET['password'],
]);
```

The following query will be executed:

```php!
db.accounts.find({ "username": "admin", "password": "toto" });
```
</div><div>

In PHP, parameters can be transformed to an array: `dummy.php?username=admin&password[$ne]=toto` allowing us to control the request and bypass authentication.

```php!
// $_GET['password'] is now an array
// There is no filtering on the type of input, we can inject NoSQL code
db.accounts.find({ "username": "admin", "password": { "$ne": "toto" }});
```
</div></div>

<hr class="sep-both">

## ðŸ‘» To-do ðŸ‘»

Stuff that I found, but never read/used yet.

<div class="row row-cols-lg-2"><div>

* `$nin` for "NOT IN" array
* `$regex` for a condition based on a regex
</div><div>
</div></div>