# Path traversal

[![fileinc](../../../../_badges/thmp/fileinc.svg)](https://tryhackme.com/room/fileinc)
[![directory_traversal](../../../../_badges/rootme/web_server/directory_traversal.svg)](https://www.root-me.org/en/Challenges/Web-Server/Directory-traversal)

<div class="row row-cols-lg-2"><div>

Path traversal is a vulnerability allowing a hacker will manage to access files/folders that were not supposed to be available for users by exploiting the application.

⚠️ You should use [HTTP clients](/cybersecurity/red-team/s2.discovery/index.md#arsenal-) to perform path traversal attacks, as browsers may send something different from what you wrote.

For instance, `http://example.com/image-preview.php?url=...` is supposed to display an image given a URL.
</div><div>

You can use the **dot-dot-slash attack**, and give a URL such as `../../../../../etc/passwd`. You can add more `../` than needed, but try to find the least number required.

It's used by others attacks such as [File inclusion](file_inclusion.md) or [SSRF](ssrf.md).

</div></div>

<hr class="sep-both">

## Path Traversal Bypass filters

[![fileinclusion](../../../../../cybersecurity/_badges/htb/fileinclusion.svg)](https://academy.hackthebox.com/course/preview/file-inclusion)
[![fileinc](../../../../_badges/thmp/fileinc.svg)](https://tryhackme.com/room/fileinc)
[![archangel](../../../../../cybersecurity/_badges/thm-p/archangel.svg)](https://tryhackme.com/r/room/archangel)
[![php_assert](../../../../_badges/rootme/web_server/php_assert.svg)](https://www.root-me.org/en/Challenges/Web-Server/PHP-assert)
[![local_file_inclusion_wrappers](../../../../_badges/rootme/web_server/local_file_inclusion_wrappers.svg)](https://www.root-me.org/fr/Challenges/Web-Serveur/Local-File-Inclusion-Wrappers)
[![local_file_inclusion_double_encoding](../../../../_badges/rootme/web_server/local_file_inclusion_double_encoding.svg)](https://www.root-me.org/en/Challenges/Web-Server/Local-File-Inclusion-Double-encoding)
[![pyrat_auction](../../../../_badges/rootme/realist/pyrat_auction.svg)](https://www.root-me.org/en/Challenges/Realist/PyRat-Auction-83)

<div class="row row-cols-md-2 mt-4"><div>

* If there is a function removing `../`, then you can craft a payload that will only work as expected once the input was filtered.

```
Input: ....//
Apply Filter: remove ../
Output: ../
```

*  If the target application decodes URLs more than once <small>(which is not the default in PHP)</small>, we may be able to bypass a WAF or similar solutions using [Double URL encoding](/tools-and-frameworks/knowledge/encoding/index.md).

* The path may have to start with a specific folder, in which case, you can simply use `folder/../<payload>`.

* Some systems support `/./` or `//` in payloads, which may be handy to bypass naive filters, such as with `/etc/./passwd`.
</div><div>

* The **null byte `%00`** could be used in **PHP < 5.3.4** to ignore trailing extensions such as `.png` below:

```php!
include "xxx.png%00.php" // include xxx.png
```

* We can exploit PHP string truncation in **PHP < 5.3.0** to craft a payload, as strings longer than 4096 are truncated.

* If they are using `assert()` to filter characters such as `..`, we may be able to exploit it. Refer to [hacktricks notes](https://book.hacktricks.xyz/pentesting-web/file-inclusion#lfi-via-phps-assert).
</div></div>