# HTTP Requests

There are multiple ways to abuse HTTP requests.

<div class="row row-cols-lg-2"><div>

#### HTTP Verb Tampering

[![web_attacks](../../../../_badges/htb/web_attacks.svg)](https://academy.hackthebox.com/course/preview/web-attacks)
[![http_verb_tampering](../../../../_badges/rootme/web_server/http_verb_tampering.svg)](https://www.root-me.org/en/Challenges/Web-Server/HTTP-verb-tampering)
[![it_happens_sometimes](../../../../_badges/rootme/realist/it_happens_sometimes.svg)](https://www.root-me.org/en/Challenges/Realist/It-happens-sometimes-93)

If the webserver is misconfigured or the code contains logic flaws, another HTTP method might be accepted while we are denied access with the 'intended' forbidden HTTP methods.

* **Ex**: A website expecting a POST request but using `$_REQUEST` may be vulnerable to injection using GET ([Refer to Logic Flaws](/cybersecurity/red-team/s2.discovery/techniques/websites/logic_flaws.md#php-_request-logic-flaw))

* **Ex**: A website using `.htaccess` to request a password might be misconfigured and bypassed using `GETS` or `PUT` etc.

<br>

#### HTTP CRLF Attack

[![crlf](../../../../_badges/hacktricks/crlf.svg)](https://book.hacktricks.xyz/pentesting-web/crlf-0d-0a)
[![crlf](../../../../_badges/rootme/web_server/crlf.svg)](https://www.root-me.org/en/Challenges/Web-Server/CRLF)

[CRLF Injection](https://en.wikipedia.org/wiki/HTTP_response_splitting) can be used for request smuggling or log corruption. For instance, it may be used to  insert malicious logs.
</div><div>

#### HTTP Request Smuggling

[![httprequestsmuggling](../../../../_badges/thm/httprequestsmuggling.svg)](https://tryhackme.com/r/room/httprequestsmuggling)

Request Smuggling occurs request that is interpreted as two by the back-end while load-balancers/reverse proxies only saw one request.

When both `Content-Length` <small>(CL)</small> and `Transfer-Encoding` <small>(TE)</small> are present, each solution may differently interpret the size of the request.

<details class="details-n">
<summary>HTTP Response Size</summary>

* `Content-Length`: size of the request in bytes
* `Transfer-Encoding: chunked`: request split in chunks

```text!
...
Transfer-Encoding: chunked
    
e              // size of data
Hello, World!  // data (13+1 bytes for \n)
0              // end
```
</details>

* **CL.TE**: use `Content-Length` with first chunk 0
* **TE.CL**: use `Content-Length: (n+2)` with `n` the size in bytes of the chunk. No need to TE in the request in the chunk.

ðŸ“š Usage: evade firewalls, cache poisoning, etc.
</div></div>

<hr class="sep-both">

## ðŸ‘» To-do ðŸ‘»

Stuff that I found, but never read/used yet.

<div class="row row-cols-lg-2"><div>

* [HTTP Header Injection](https://en.wikipedia.org/wiki/HTTP_header_injection)
</div><div>
</div></div>