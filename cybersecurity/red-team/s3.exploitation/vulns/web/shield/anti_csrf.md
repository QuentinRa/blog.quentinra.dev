# Anti-CSRF Token

[![sqlmapessentials](../../../../../_badges/htb/sqlmapessentials.svg)](https://academy.hackthebox.com/course/preview/sqlmap-essentials)
[![session_security](../../../../../_badges/htb/session_security.svg)](https://academy.hackthebox.com/course/preview/session-security)
[![gitlabcve20237028](../../../../../_badges/thm-p/gitlabcve20237028.svg)](https://tryhackme.com/r/room/gitlabcve20237028)
[![unbakedpie](../../../../../_badges/thm-p/unbakedpie.svg)](https://tryhackme.com/r/room/unbakedpie)

**The most common scenario**: fetch a page using GET, get the token, use it for the next request.

<div class="row row-cols-lg-2"><div>

Some websites have a CSRF token, mostly attached to HTML forms, as a form of protection against CSRF attacks and other automation tools.

It's a generated value that is added to the form, often as a hidden HTML `<input>` field. It proves that someone submitting a form effectively visited the page with the form beforehand.

CSRF tokens should be randomly generated. Do not use `md5(username)` or similar guessable token generation functions.

Many tools have built-in switches to handle/bypass such forms.
</div><div>

A few other inappropriate settings

* The server only checks if the header is present
* The server only checks if the length of the token
* The server only checks the token if it was sent
* We can use someone else's CSRF token
* We can reuse a CSRF token
* Verb tampering may bypass CSRF verification

There is also the [Double-Submit Cookie Pattern](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html#alternative-using-a-double-submit-cookie-pattern) but it can be bypassed by giving an arbitrary value to both the cookie and the header.
</div></div>