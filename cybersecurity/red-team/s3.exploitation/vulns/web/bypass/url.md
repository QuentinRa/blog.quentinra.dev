# URL and Path Bypasses

<div class="row row-cols-lg-2"><div>

#### Extension Filter Bypass — Null Byte

[![fileuploadattacks](../../../../../_badges/htb/fileuploadattacks.svg)](https://academy.hackthebox.com/course/preview/file-upload-attacks)
[![uploadvulns](../../../../../_badges/thmp/uploadvulns.svg)](https://tryhackme.com/room/uploadvulns)
[![null_byte](../../../../../_badges/rootme/web_server/null_byte.svg)](https://www.root-me.org/en/Challenges/Web-Server/File-upload-Null-byte)
[![upload_with_null_byte](../../../../../_badges/ps-lab/upload/upload_with_null_byte.svg)](https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-obfuscated-file-extension)

The null byte <small>(PHP < 5.3.4)</small> could be used to bypass filters:

```text!
malicious.php%00.png -> malicious.php
malicious.php\x00.png -> malicious.php
```

#### Extension Filter Bypass — Windows Trail

[![fileuploadattacks](../../../../../_badges/htb/fileuploadattacks.svg)](https://academy.hackthebox.com/course/preview/file-upload-attacks)

This is only possible on Windows targets:

```text!
file.php:.jpg -> file.php
file.php;.jpg -> file.php
```

#### Extension Filter Bypass — PHP String Truncation

We can exploit PHP string truncation in **PHP < 5.3.0** to craft a payload. From my experience, it only works when the string has a certain size which is often strictly equals to 4095.

```py!
# must be an odd number of characters in the path
payload = 'a/../admin.html' + '/.' * 2026
payload = 'abc/../admin.html' + '/.' * 2025
payload = 'admin.html/' + '/.' * 2028
```
</div><div>

#### Character Filter Bypass — Remove Filter

A filter removing invalid characters may not be recursive.

```text!
../ -> 
....// -> ../ 
....\/ -> ../ 
```

#### Character Filter Bypass — URL Encoding

There may be a discrepancy between the system that verify the request and the one that is processing the request.

- [ ] Attempt a mix of URL-encoding `.%2e%2f` for edge cases
- [ ] Use double URL encoding <small>(for recursive parsers)</small>
- [ ] Attempt `..%c0%af` or `..%ef%bc%8f`

#### Filename Filter Bypass — Path Extension

If there is a filter strings such as `/etc/passwd`.

```text!
/etc/passwd   ===========> 
/etc//passwd  =====Linux=> /etc/passwd 
/etc/./passwd ===PHP 5.3=> /etc/passwd 
```
</div></div>

<hr class="sep-both">

## Advanced Techniques

<div class="row row-cols-lg-2"><div>

#### XSS Relative Path Override (RPO)

[![xss_reflected](../../../../../_badges/rootme/web_client/xss_reflected.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-Reflected)

Usually, a URL such as `http://example.com/a/../toto` is processed and replaced with `http://example.com/toto` before it is used.

We can use a mix of URL encoding and not encoded characters to create a URL that is not shortened but still point to a relative folder.

```diff
-https://example.com/../toto/index.php
+https://example.com/..%2Ftoto/index.php
```

This can be used to trick checks like "URL starts with".
</div><div>
</div></div>