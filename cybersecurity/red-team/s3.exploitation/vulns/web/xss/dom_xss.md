# DOM-based XSS

[![introductiontowebapplications](../../../../../_badges/htb/introductiontowebapplications.svg)](https://academy.hackthebox.com/course/preview/introduction-to-web-applications)
[![cross_site_scripting](../../../../../_badges/htb/cross_site_scripting.svg)](https://academy.hackthebox.com/course/preview/cross-site-scripting-xss)
[![xssgi](../../../../../_badges/thmp/xssgi.svg)](https://tryhackme.com/room/xssgi)
[![xss](../../../../../_badges/thmp/xss.svg)](https://tryhackme.com/room/xss)
[![xss_dom_based_introduction](../../../../../_badges/rootme/web_client/xss_dom_based_introduction.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Introduction)
[![xss_dom_based_filters_bypass](../../../../../_badges/rootme/web_client/xss_dom_based_filters_bypass.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Filters-Bypass)
[![xss_dom_based](../../../../../_badges/rootme/web_client/xss_dom_based.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based)
[![xss_dom_based_eval](../../../../../_badges/rootme/web_client/xss_dom_based_eval.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-Eval)
[![xss_dom_based_angularjs](../../../../../_badges/rootme/web_client/xss_dom_based_angularjs.svg)](https://www.root-me.org/en/Challenges/Web-Client/XSS-DOM-Based-AngularJS)
[![xss_document_write](../../../../../_badges/ps-lab/xss/xss_document_write.svg)](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-document-write-sink)
[![xss_js_string](../../../../../_badges/ps-lab/xss/xss_js_string.svg)](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-javascript-string-angle-brackets-html-encoded)
[![xss_innerhtml](../../../../../_badges/ps-lab/xss/xss_innerhtml.svg)](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-innerhtml-sink)
[![xss_jquery_href](../../../../../_badges/ps-lab/xss/xss_jquery_href.svg)](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-jquery-href-attribute-sink)
[![dom_xss_web_messages](../../../../../_badges/ps-lab/xss/dom_xss_web_messages.svg)](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages)
[![dom_xss_web_messages_js_sink](../../../../../_badges/ps-lab/xss/dom_xss_web_messages_js_sink.svg)](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages-and-a-javascript-url)
[![dom_xss_web_messages_json_sink](../../../../../_badges/ps-lab/xss/dom_xss_web_messages_json_sink.svg)](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages-and-json-parse)

<div class="row row-cols-lg-2"><div>

DOM-based XSS occur without the server being aware of them. The client-side JavaScript is the one rendering the payload. For instance, when we use `xxx.innerHTML` or `document.write` <small>(referred to as "a sinker")</small>.

* [ ] Application executing JavaScript based on a parameter

```html!
<script>
    // https://example.com/?search=alert(1)
    const params = new URLSearchParams(location.search);
    eval(params.get('search'))
</script>
```

* [ ] Application executing JavaScript based on an anchor

```html!
<script>
    const input = document.location.hash.substring(1)
    eval(input)
</script>
```
</div><div>

* [ ] Application listening to untrusted sources

```html!
<script>
// vulnerable code, not validating "e.origin" securely
// (+see URL/Path traversal bypasses: subdomain often works)
window.addEventListener('message', function(e) {
	document.getElementById('ads').innerHTML = e.data;
})
</script>
```

```html!
<iframe width=1080 height=1080 src="https://example.com/" 
        onload="mypayload">
```

```js!
this.contentWindow.postMessage('<img src=1 onerror=print()>','*')
this.contentWindow.postMessage('javascript:print()//http://','*')
```
</div></div>