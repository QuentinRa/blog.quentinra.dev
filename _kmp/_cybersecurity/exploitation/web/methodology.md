# Methodology to exploit webservers

<div class="row row-cols-md-2 mt-4"><div>

üåü  **Look for logic flaws**

A logic flaw is when a programmer is thinking that a user will do something, such as browsing pages in a specific order, or submitting an email in an "email input field", and does not check, or not properly check, for those that take a path different from intended.

Another logic flaw could be related to websites using a username to check if a user is allowed to see the "admin" side of the website. Maybe some tricks like a username " admin" may bypass the check.

<br>

üåü  **Look for frameworks** [See frameworks](frameworks/index.md)

Most developers are using a framework, which is a sort of box of utilities to make a website more easily.

‚û°Ô∏è Try the framework default credentials (if any).

<br>

</div><div>

üåü  **Forced Browsing** [See Forced Browsing](fuzz/forced_browsing.md)

This is a technique of not using the website links to navigate to another page, but rather trying manually/using a tool with a list of routes that may exist, and trying them all while hoping to find some gold.

<br>

üåü  **Insecure Direct Object References (IDOR)** [See fuzzing](fuzz/index.md)

[![idor](../../_badges/thm/idor.svg)](https://tryhackme.com/room/idor)
[![neighbour](../../_badges/thm-p/neighbour.svg)](https://tryhackme.com/room/neighbour)

A failure in which we can guess given a URL how to access other elements,
and if we change the URL <small>(id=10$\to$id=11)</small>. It could be a get form with predictable values, or a folder with predictable filenames... It could also be unpredictable values, and in such case, the best test would be to create two accounts, and see if you can swap the potential IDOR. They can be found in forms, in the JavaScript, in cookies...

<br>

üåü  **Find usernames/emails** [See Brute force forms](forms/index.md)

You could achieve this using the website API if there is one, and/or its interface, such as register forms: "this username is already taken", or the same process for emails with the password forgot page...
</div></div>

<hr class="sep-both">

## üé£ Toolsüé£

<div class="row row-cols-md-2"><div>

* [nikto](https://github.com/sullo/nikto) (6.2k ‚≠ê). Scan web server for known vulnerabilities.

```bash
$ nikto -h URL
# Server
# SSL certificate
# Headers
```

* Spoof User-Agent

You can install an extension to make the target website believe that you are using another browser. Look for **User-Agent Switcher** extensions on Google. You can try them on [whatismybrowser](https://www.whatismybrowser.com/).

* Use a proxy

You may use a proxy as an intermediary for your requests. If you do, then you can use the **FoxyProxy extension** of your browser to easily swap between no proxy, and your proxies configurations.
</div><div>

* Disable scripts

You may do that to bypass JavaScript verifications. You can use plugins such as [noscript](https://noscript.net/), or ublock by clicking on the following icon

![ublock_disable_scripts](_images/ublock_disable_scripts.png)

* [wappalyzer](https://github.com/wappalyzer/wappalyzer) (7.8k ‚≠ê) to find frameworks, their versions... It can also be installed as a browser extension or used via their [website](https://www.wappalyzer.com/). If you are using the extension, you might want to uncheck the option to send anonymous data to their website.

* [Beef](https://github.com/beefproject/beef) (7.8k ‚≠ê): The Browser Exploitation Framework Project
</div></div>

<hr class="sep-both">

## Mitigations

<div class="row row-cols-md-2 mt-4"><div>

* üîí Display generic error messages, disable errors messages, and do not give much information <small>(ex: on invalid login, display the message 'credentials invalid', instead of 'username invalid' or 'password invalid')</small>

* üöß Test your endpoints with invalid values: 0, -1, characters, symbols... Test your pages with/without excepted parameters, especially if a hacker tries to access pages in an unexpected order.
</div><div>

* üî´ Do not trust anything coming from the user, its browser, or even your database. Basically, Zero Trust.
</div></div>