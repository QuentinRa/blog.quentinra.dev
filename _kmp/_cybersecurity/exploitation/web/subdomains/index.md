# Subdomains enumeration

[![subdomainenumeration](../../../_badges/thmp/subdomainenumeration.svg)](https://tryhackme.com/room/subdomainenumeration)

<div class="row row-cols-md-2"><div>

Subdomain enumeration is a process in which a hacker will try to look for subdomains that may be used to launch an attack.

As a reminder, a domain is something like `example.com`, while a subdomain may be

* `www.example.com`
* `v2.www.example.com`
</div><div>

[Wordlists](/_cybersecurity/exploitation/general/index.md#-wordlists-) that you may use

* package wordlist: `/usr/share/wordlists/amass/`
* package seclists üìå: `/usr/share/seclists/Discovery/DNS/`

```            
bitquark-subdomains-top100000.txt    italian-subdomains.txt                            subdomains-top1million-110000.txt
combined_subdomains.txt              namelist.txt                                      subdomains-top1million-20000.txt
deepmagic.com-prefixes-top50000.txt  README.md                                         subdomains-top1million-5000.txt
deepmagic.com-prefixes-top500.txt    shubs-stackoverflow.txt                           tlds.txt
dns-Jhaddix.txt                      shubs-subdomains.txt
fierce-hostlist.txt                  sortedcombined-knock-dnsrecon-fierce-reconng.txt
```

</div></div>

<hr class="sep-both">

## Virtual Hosts

<div class="row row-cols-md-2"><div>

A server can serve multiple domains using what we call virtual hosts. When a request is received, the header "HOST" allows the server to know which domain name was queried, and send back the appropriate resource.

It's possible for subdomains records to be only available locally, on the server <small>(`/etc/hosts`, or `c:\windows\system32\drivers\etc\hosts`)</small>, usually for websites that aren't meant to be discovered/available to the public.
</div><div>

The server will process as usual, whether the subdomain is public or not, if someone requests it, and there is indeed such a domain name, then it will be served to the user.
</div></div>

<hr class="sep-both">

## DNSRecon

<div class="row row-cols-md-2 mt-4"><div>

[DNSRecon](https://github.com/darkoperator/dnsrecon) (2k ‚≠ê) is a Python script that can be used to brute force DNS, and OSINT checks (see std, bing, yandex, and crt).

```bash
$ dnsrecon -d URL -t type
$ dnsrecon -d URL -D wordlist -t type
```
</div><div>

The type could be

* `brt`: brute force using a dictionary
* `std`: NS, A/AAAA, MX...
* `bing`: test bing
* `yand`: test Yandex
* `rvl`: reverse lookup
* `crt`: test [crt.sh](https://crt.sh/)
* ...
</div></div>

> I would advise testing other tools too...

<hr class="sep-both">

## Brute force

<div class="row row-cols-md-2"><div>

You can use [ffuf](../fuzz/index.md#ffuf---fuzz-faster-u-fool) for DNS subdomains, and virtual hosts.

```bash
# virtual hosts
$ ffuf -w wordlist -H "Host: FUZZ.example.com" -u example.com
# subdomains
$ ffuf -w wordlist -u FUZZ.example.com
```

> As every response having the same size, for instance, are most likely the same answer (failure).
</div><div>

You can use [Gobuster](../fuzz/forced_browsing.md#gobuster-go) for DNS subdomains, and Virtual hosts. In newer versions, you need to add `--append-domain` to check `xxx.example.com`, and not just `xxx`.

```bash
# virtual hosts
$ gobuster vhost -u URL -w wordlist --append-domain
# subdomains
$ gobuster dns -d URL -w wordlist
```
</div></div>