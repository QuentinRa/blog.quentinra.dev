# Cookies

[![authenticationbypass](../../../_badges/thmp/authenticationbypass.svg)](https://tryhackme.com/room/authenticationbypass)

<div class="row row-cols-md-2"><div>

Cookies are used by a server to store data inside a client's browser.

* The server first sends instructions to create cookies
* This is done using the header `Set-Cookie` (one per cookie)
* The client will transfer back cookies in every request to the server

Cookies can be used

* ðŸ“¦ to store data in the client browser
  * Ex: language
  * Ex: the mode (dark/light)
  * Ex: the name of the user logged (mostly in CTF)
  * Ex: sometimes you will see credentials too in CTF...
  * ...
* ðŸ‘‘ store a session id

> Cookies are usually encoded, mostly in base64. See [encoding](/_cybersecurity/random/encoding/index.md).
</div><div>

**Sessions cookies**

Session cookies are used to store data on the server, associated with someone visiting the website. Once the session is started server-side, a file will be created on the server with an id such as `f71dbe52628a3f83a77ab494817525c6`. The programmer can store inside stuff like

* is the user connected?
* the user information such as the clientID...
* ...

A session is available on every page server-side, so programmers use it to adapt the page according to what we know about the user <small>(ex: not logged in $\to$ redirect to the login page)</small>. 

The server will send the session id in a cookie, and the client will send it back in every request (like a normal cookie), so that the session manager will load the right session file on the server.
</div></div>

<hr class="sep-both">

## Insecure Deserialisation

[![owasptop10](../../../_badges/thm/owasptop10.svg)](https://tryhackme.com/room/owasptop10)
[![deserialization](../../../_badges/owasp/deserialization.svg)](https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html)

<div class="row row-cols-md-2"><div class="align-self-center">

Insecure Deserialisation is a vulnerability that occurs when the deserialization process can be exploited to run malicious code.
</div><div>

> **CVE-2021-33026**: an insure deserialization in Flask (Python) allowed a hacker to encrypt a command (ex: reverse shell) in base64, then replace the base64 legitimate value with the malicious one, and voilÃ , loading the page again will open the reverse shell.
</div></div>

<hr class="sep-both">

## ðŸ‘» To-do ðŸ‘»

Stuff that I found, but never read/used yet.

<div class="row row-cols-md-2"><div>

* [Hackers are using cookies to sidestep two-factor authentication](https://www.databreaches.net/hackers-are-using-cookies-to-sidestep-two-factor-authentication/)
* [Cookie Stealing or Scraping](https://www.thewindowsclub.com/cookie-stealing-or-scraping)
* [session hijacking](https://us.norton.com/internetsecurity-id-theft-session-hijacking.html)
</div><div>

* [Hackers Stealing Browser Cookies to Hijack YouTube Accounts](https://thehackernews.com/2021/10/hackers-stealing-browser-cookies-to.html)
* [Flask Session Cookie Decoder](https://www.kirsle.net/wizards/flask-session.cgi)
* [medium/swlh](https://medium.com/swlh/web-security-sessions-and-tokens-6468c6feaa41)
</div></div>