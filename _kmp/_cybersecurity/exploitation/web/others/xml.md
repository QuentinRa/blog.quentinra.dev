# XML External Entity (XEE)

[![owasptop10](../../../_badges/thm/owasptop10.svg)](https://tryhackme.com/room/owasptop10)
[![xxe_injection](../../../_badges/poat/xxe_injection.svg)](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection)

<div class="row row-cols-md-2"><div>
</div><div>

An **XML External Entity (XEE)** is an attack exploiting XML parsers used by applications. To be more accurate, you will create a custom **DTD** that will do something on the server. This may lead to

* a **[SSRF attack](../forms/ssrf.md)**: request resource (file/...), map open ports...
* a **sensitive file disclosure**
* a **Denial of Service (DoS)** with recursive instructions
* ...

As usual, there are two kinds of XEE

* **In-band XEE**: same channel to attack and fetch results
* **Out-band/Blind XEE**: different channels to attack and fetch results

<p class="text-center py-3">➡️ Example of payload</p>

Once parsed, this malicious payload will store inside root the content of `/etc/passwd`.

<pre class="language-xml">
<code
>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE root [&lt;!ENTITY poc SYSTEM 'file:///etc/passwd']&gt;
&lt;root&gt;&poc;&lt;/root&gt;
</code></pre>
</div></div>