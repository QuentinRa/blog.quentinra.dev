# Bruteforce services

[![agentsudoctf](../../_badges/thm-p/agentsudoctf.svg)](https://tryhackme.com/room/agentsudoctf)
[![basicpentestingjt](../../_badges/thm-p/basicpentestingjt.svg)](https://tryhackme.com/room/basicpentestingjt)
[![netsecchallenge](../../_badges/thmp-p/netsecchallenge.svg)](https://tryhackme.com/room/netsecchallenge)
[![cowboyhacker](../../_badges/thm-p/cowboyhacker.svg)](https://tryhackme.com/room/cowboyhacker)

> There are tools such as `fail2ban` to block users after $n$ failed tries within a timeframe of $x$ seconds.

<hr class="sep-both">

## Hydra

[![hydra](../../_badges/thm/hydra.svg)](https://tryhackme.com/room/hydra)

<div class="row row-cols-md-2"><div>

[Hydra](https://github.com/vanhauser-thc/thc-hydra) (6.8k ‚≠ê, ü•á) is a well-known tool to bruteforce authentication services such SSH, FTP, RDP, MySQL... It can even be used on login forms, but that's explained somewhere else.

```bash
$ wordlist=/usr/share/wordlists/rockyou.txt
# use ssh, ftp...
$ hydra -l username -P $wordlist ssh://IP
$ hydra -l username -P $wordlist ftp://IP:port
$ [...]
# alternate form
$ hydra -l username -P $wordlist IP ssh
```

> Note: I use a variable `$wordlist` to write shorter commands. <br>
> You can learn more about [wordlists here](/cyber/exploitation/general/index.md#-wordlists-) üñãÔ∏è.
</div><div class="align-self-center">

* `-l username`: try this username
* `-L file`: try a list of usernames
* `-p password`: try this password
* `-P file`: try a list of passwords
* `-C file`: instead of L/P, provide a list of "username:password"
* `-s port`: use another port
* `-t n`: use $n$ threads (default: 16)
* `-v` / `-d` : verbose / debug
* `-V`: show login+password for every attempt
* `-e [values]` such as `-e nsr` for all three
  * `n`: try null password
  * `s`: try login as pass
  * `r`: try reversed login
</div></div>

<hr class="sep-both">

## Nmap

[See nmap if you are not familiar with it](/cyber/discovery/nmap/index.md)

<div class="row row-cols-md-2 mt-3"><div>

```bash
$ nmap IP -p 22 --script ssh-brute --script-args userdb=users.lst,passdb=pass.lst
```

You can actually load every brute force script

```bash
$ nmap IP --script "*brute*" --script-args userdb=users.lst,passdb=pass.lst
```
</div><div class="align-self-center">

<p class="text-center"><b>ü•à Note that it's uncommon, use hydra ü•à</b></p>

The command is taking two [wordlists](/cyber/exploitation/general/index.md#-wordlists-), basically files with one username/password per line, and it will try the cartesian product of both files <small>(i.g. the first username with every password, then the second username...)</small>.

> See [nmap list of brute force scripts](https://nmap.org/nsedoc/categories/brute.html).
</div></div>