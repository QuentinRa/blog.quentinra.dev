# Exploit a webserver

[![introwebapplicationsecurity](../../_badges/thm/introwebapplicationsecurity.svg)](https://tryhackme.com/room/introwebapplicationsecurity)
[![contentdiscovery](../../_badges/thm/contentdiscovery.svg)](https://tryhackme.com/room/contentdiscovery)
[![walkinganapplication](../../_badges/thm/walkinganapplication.svg)](https://tryhackme.com/room/walkinganapplication)
[![httpindetail](../../_badges/thm/httpindetail.svg)](https://tryhackme.com/room/httpindetail)
[![authenticationbypass](../../_badges/thmp/authenticationbypass.svg)](https://tryhackme.com/room/authenticationbypass)

*According to TryHackMe, there are 4 categories of failures related to webservices.*

<div class="row row-cols-md-2"><div>

**Identification and Authentication Failure** üîë

* The website do not prevent bruteforce
* The website allows users to use weak passwords
* The website do not encrypt passwords
	
<br>

**Broken Access Control** üì≠ <small>(a hacker can access files/URLs we shouldn't)</small>

* The principle of the least privilege not applied correctly
* Someone can use someone else token/id to do...
* A user can access "logged-only" pages without logging in
</div><div>

**Injections** ü™§

* There is an insufficient, or no validation at all
* There is an insufficient, or no sanitization at all

<p>&nbsp;</p>

**Cryptographic Failures** üîì

* The server is using clear text
* The server allow/use HTTP instead of HTTPS
* The server use a weak cryptographic algorithm
</div></div>

<hr class="sep-both">

## Terminology

<div class="row row-cols-md-2"><div>

A URL is a suite of: a scheme (http/https), a username, a password, `@`, a domain, `:`, a port, a route, a query (`?`), and a fragment (`#`). Most parameters are options, and URLs you will use will mostly look like this

```
http://example.com
http://example.com:80
https://example.com
https://example.com:443
https://example.com/route/?query#fragment
127.0.0.1
127.0.0.1:80
[...]
```

Requests are using a method to send something to the server.

* `GET`: get a resource
* `POST`: upload a resource
* `PUT`: update ONE field of a resource
* `DELETE`: delete a resource
* ...
</div><div>

And a request has headers both set by the client, and the server, in order for each of them to send more information than just data:

* `Set-cookie`: if the server want to create a cookie
* `Host`: the server that the request is addressing
* `Server:` (opt): name of the HTTP service, its version, and even the OS
* ...

The server will answer with an [HTTP response code](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status) according to how it could handle the request (200=OK, 301/303=redirected, 404=Not found, 500=Internal error...).

**Random**

* Web Application Firewall (WAF): protect web apps against DDOS/..., and analyse/limit-rate traffic from bots.
* Content Delivery Networks (CDN): servers that are used to store static resources of a website. When a website needs a resource, the nearest CDN server is used, allowing a faster response.
* Load Balancers: interface between clients and server, distributing the load among the available servers using algorithms such as round-robin <small>(in turn)</small>, or weighted <small>(is server busy?)</small>. There are periodic check to ensure that servers are still online, and if there is no response, a server is considered down until proven otherwise.
</div></div>

<hr class="sep-both">

## OWASP, and references

<div class="row row-cols-md-2"><div>

[OWASP](https://owasp.org/) (The Open Source Foundation for Application Security Project) is a foundation that is very well-known for there resources to improve websites security. The release every year the [**Top 10 vulnerabilities**](https://owasp.org/Top10/).

> See [OWASP Cheat Sheet Series](https://cheatsheetseries.owasp.org/) (22.1k ‚≠ê)<br>
> See [OWASP Juice Shop](https://github.com/juice-shop/juice-shop) (7.4k ‚≠ê): practice<br>
> See [OWASP Web Security Testing Guide](https://owasp.org/www-project-web-security-testing-guide/) (5k ‚≠ê, [PDF](https://github.com/OWASP/wstg/releases/download/v4.2/wstg-v4.2.pdf))
</div><div>

**Other tools**

* [wappalyzer](https://github.com/wappalyzer/wappalyzer) (7.8k ‚≠ê) to find frameworks, their versions... It can also be installed as a browser extension or used via their [website](https://www.wappalyzer.com/).
* [Beef](https://github.com/beefproject/beef) (7.8k ‚≠ê): The Browser Exploitation Framework Project

**Other dummy websites for practice**

* [Damn Vulnerable Web Application (DVWA)](https://github.com/digininja/DVWA) (6.8k ‚≠ê)
* [bugbountyhunter training](https://www.bugbountyhunter.com/training/)
* [bwapp](http://www.itsecgames.com/download.htm) which isn't maintained since 2014, and do not seem very popular. There is  [this repository](https://github.com/raesene/bWAPP) (95 ‚≠ê) about it, and [bWapp solutions](https://github.com/skiptomyliu/solutions-bwapp) (152 ‚≠ê).

**Checklists**

* [appsec-labs.com/web-attacks-tests](https://appsec-labs.com/web-attacks-tests/)
</div></div>

<hr class="sep-both">

## Discovery of a website

> Below is a sort of checklist of what you will have to go through when exploring a website, but to get what you want, you will have to look at specific pages according to your case.

<div class="row row-cols-md-2"><div>

**Look at the source of the website** (<kbd>CTRL+U</kbd>)

* is there hidden elements?
* is there information in HTML comments?

<br>

**Look for logic flaws**

A logic flaw is when a programmer is thinking that a user will do something, such as visiting page in a determined order, or submitting an email in an "email input field", and do no check, or not properly check, for those that take a path different than intended.

<br>

**Look for frameworks** [See frameworks](frameworks/index.md)

Most developers are using a framework, which is a sort of box of utilities to make a website more easily.

<br>

**Analyse the network**

You may the dev console network tab to analyse requests, and responses send to the server. Once you click on a request, there are multiple tabs, for the request, the response...

Some misconfigured servers are for instance, sending the web service name <small>(Nginx, Apache, IIS, Node.js)</small>, and sometimes even the version.

<br>

**Analyse the javascript**

You may use the dev console debugger, after adding a breakpoint in the JavaScript, to analyze the javascript code, if needed.

<br>

**/robots.txt and /sitemap.xml**

Robots.txt are listing pages that crawlers (search engine robots) shouldn't crawl. There may be some routes that even clients were not aware of inside.

There is also a link to the website "sitemap", which is generated by the developer to help search engine index the website. If the sitemap wasn't updated, you may find interesting routes, meaning not available for the "usual" visitor, but that were available before, that were not removed, and that are maybe vulnerable.

<br>

**Website mapping**

As a penetration tester, you will have to list every feature of the website, and their route. For instance, "list all products": `/products,` "list a product": `/products?id=x`. This is done as you explore by BurpSuite.
</div><div>

**Forced Browsing** [See Forced Browsing](files/forced_browsing.md)

This is a technique of not using the website links to navigate to another page, but rather trying manually, or not, page that may exist on the website, while hoping to find some gold.

<br>

**Insecure Direct Object References (IDOR)** [See fuzzing](fuzz/index.md)

[![idor](../../_badges/thm/idor.svg)](https://tryhackme.com/room/idor)
[![neighbour](../../_badges/thm/neighbour.svg)](https://tryhackme.com/room/neighbour)

A failure in which we can guess given a URL how to access other elements,
and if we change the URL <small>(id=10$\to$id=11)</small>. It could be a get form with predictable values, a folder with predictable filenames... It could also be unpredictable values, and in such case, the best test would be to create two accounts, and see if you can swap the potential IDOR. They can be found in forms, in the JavaScript, in cookies...

<br>

**Find usernames/emails** [See Bruteforce forms](forms/index.md)

You could achieve this using the website API if there is one, and/or its interface, such as register forms: "this username is already taken", or the same process for emails with the password forgot page...

<br>

**Wayback machine**

You can look for old version of the website stored on the [Wayback machine](https://archive.org/web/), if any. Google has also a feature to see cached versions of a website, but it's not very useful for this purpose.

<br>

**OSINT**

If the company tried to hire employees in the past, you may find information about the framework or stuff like this in the job offers.

If you can find employees on GitHub/..., you may find what language/frameworks they are using for their websites.

You may also look for personal websites/posts/interest of employees, because that may be an indicator too.
</div></div>

<hr class="sep-both">

## Random

<div class="row row-cols-md-2"><div>

You can install an extension to make the target website believe that you are using another browser. Look for **User-Agent Switcher** extensions on Google. You can try them on [whatismybrowser](https://www.whatismybrowser.com/).
</div><div>

You may use a proxy as an intermediary for your requests. If you do, then you can use the **FoxyProxy extension** of your browser to easily swap between no proxy, and your proxies configurations.
</div></div>