## Installing Cypher

First, let's install Cypher.
You can use 

* the [online](https://neo4j.com/sandbox/) database
* or [install](https://neo4j.com/download/) Neo4J Desktop

Once you did (after creating an account in both cases),
you should

* create a new project (a group of databases)
* create a new database
* then start your database

If you are planning to use this in a project (like
in Java, JS, PHP or Go) then you should look 
at the [driver page](https://neo4j.com/developer/language-guides/).

You may also try reading the official
documentation [here](https://neo4j.com/developer/get-started/).

If you are a **Jetbrains** user, then
you may enjoy "Graph Database Console" plugin.

[Here](movies.cypher) is a database create by my teacher,
[Stefania Dumbrava](http://web4.ensiie.fr/~stefania.dumbrava/)
that I will use in this course.

<hr class="sr">

## Core concept

Here this is what a query result will looks like

![example](example.png)

You got 

* **4 nodes**, each node is like a tuple in a SQL database,
  they have properties called **attributes**
* **3 edges**, they are the relation between the nodes,
  you may have a lot of them between two nodes and in
  a lot of directions

That's what we call a graph.

<hr class="sl">

## Nodes

A **node** is defined between ``()`` giving you something
like this ``(ref:label{})`` where

* **ref**, is an optional variable name,
  that may be used for storing the node
  for the query
* **:label** is optional, it's like
  a table name in SQL or a class in UML
* **{}** are the attributes of the object, optional
  too. The format for this is JSON 
  (`{ attribute:value, ... }`)

Ex

* ``(:label)`` nodes without properties having the label "label"
* ``(ref:label {attribute:value})`` store in ref a node having the label
  "label" and "value" for "attribute".
* ``(ref {attribute: value})`` store in ref ...

<hr class="sr">

## Edges

An **edges** defined between ``[]`` and two nodes
giving you something like this ``node-[ommited]->node``
where

* **node** is a node (can be the same or two different ones),
  you can omit both otherwise you must give both
* **omitted** is also a node (so `(ref: label{})`) where
  * **ref**: will be used to store the edge
  * **label**: label of the edge like "player-[:Playing]->game"
    Playing here. It's would be a association name in UML.
  * **{}**: the properties of the edge, you may
    see this as the attributes in a **association class**
    in UML

You got a lot of kind of edges

* ``--`` : anonymous without direction
* ``-->`` : anonymous with direction
* ``-[:label]->`` : edge labelled "label" with direction

Ex

* ``(:Movie)<-[e]-(:ShowbizPerson)``: store
  into e the edge(s) from a ShowbizPerson to a Movie
* ``(:ShowbizPerson)-[e]->()``: store in e the edge(s)
  from ShowbizPerson to any other kind of
  nodes

<hr class="sl">

## Make a request

A request will looks like this

```sql
// simple request
MATCH (ref)
// returns the node(s)
RETURN ref; // optional ;

// more complex
MATCH (ref)
WHERE a_condition
RETURN ref.attribute
LIMIT a_value
```

The most used clauses are

* [MATCH](clause/match.md) (SQL From)
* [RETURN](clause/return.md) (SQL Select)
* [WHERE](clause/where.md) (SQL Where)
* [LIMIT AND SKIP](clause/limit.md) (SQL Limit)
* [ORDER BY](clause/order-by.md) (SQL Order by)
* [OPTIONAL MATCH](clause/optional-match.md) (a second From)
* [MATCH WITH](clause/with.md) (nested request)

Then you should practice [here](clause/exercise.md).

<hr class="sr">

## Create-Update-Delete

You can use ``CREATE`` to create new nodes / edges,
``MATCH-SET-RETURN`` to update something and
``MATCH-REMOVE/DELETE/DETACH`` to remove something.

* [Create](ddl/create.md)
* [Update](ddl/update.md)
* [Delete](ddl/delete.md)

<hr class="sl">

## Functions

You might use them

* ``keys(node)``: returns the attributes names of a node
* ``properties(node)``: node attributes + values
* ``labels(node)``: returns the labels of a node
* ``nodes(path)``: returns the nodes in a path
* ``relationships(path)``: returns all the edges of a path
* ``id(node)``: id of a node

List-related

* ``range(min,max)``: returns a list of values [min, max] ([learn more]())
* ``tail(list)``: remove the first one
* ``size(list)``: size of a list
* ``reverse(list)``: reverse a list
* ``reduce(declare, var IN smth | returns)``: check lists

A list is an array of values generated by an expression.
You can write something like this (quite inspired
from python)

* ``[expression|returns]``: you can see that are
  the left expression being what we are iterating
  and the right expression is the result of one iteration.
  The list returned is made of all the iteration results.
* ``[x in range(0,5)|x]``: returns [0,1,2,3,4,5]
* ``[x in range(0,5) WHERE x+2<5 |x^2]``: returns [0,1,4,9,16,25]

You can use this like this

```sql
MATCH (ref:Movie)
; you could also put a list in a WHERE
RETURN size([ (ref)--(p:ShowbizPerson)  WHERE ref.released=2000 | p.name  ])
```